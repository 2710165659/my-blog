<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>数据库知识体系结构 | My Blog</title>
    <meta name="description" content="xuan_yuan's blog">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/assets/style.C93YGiNj.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.BgcW1JpX.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.Cv1X_qXF.js">
    <link rel="modulepreload" href="/assets/chunks/framework.BSsnj4C9.js">
    <link rel="modulepreload" href="/assets/notes_Sql.md.DW9Qcse8.lean.js">
    <link rel="icon" href="/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.png" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>My Blog</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>主页</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/projects" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>项目</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/articles" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>文章</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/notes" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>笔记</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/others" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>其他</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/2710165659/my-blog" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/2710165659/my-blog" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 has-active" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/notes/" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>主页</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/notes/Docker" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Docker</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/notes/git%E5%91%BD%E4%BB%A4" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>git命令</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/notes/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>java基础知识</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/notes/java%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>java框架学习</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/notes/Linux" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Linux</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/notes/Python" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Python</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/notes/Sql" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Sql</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/notes/Vue" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Vue</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/notes/%E7%AE%97%E6%B3%95" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>算法</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _notes_Sql" data-v-83890dd9><div><h1 id="数据库知识体系结构" tabindex="-1">数据库知识体系结构 <a class="header-anchor" href="#数据库知识体系结构" aria-label="Permalink to &quot;数据库知识体系结构&quot;">​</a></h1><h2 id="框架图" tabindex="-1">框架图 <a class="header-anchor" href="#框架图" aria-label="Permalink to &quot;框架图&quot;">​</a></h2><p><img src="/assets/Pastedimage20250724112712.CJdga9n9.png" alt=""></p><h2 id="范式" tabindex="-1">范式 <a class="header-anchor" href="#范式" aria-label="Permalink to &quot;范式&quot;">​</a></h2><h3 id="简介与核心概念" tabindex="-1">简介与核心概念 <a class="header-anchor" href="#简介与核心概念" aria-label="Permalink to &quot;简介与核心概念&quot;">​</a></h3><p>数据库范式（Database Normalization）是关系型数据库设计中的一系列规则，旨在通过消除数据冗余和提高数据完整性来优化数据库结构。简单来说，范式就是一套指导原则，帮助我们更好地组织数据库中的数据，避免数据重复和更新异常。</p><h3 id="_1-第一范式-1nf-first-normal-form" tabindex="-1">1. 第一范式 (1NF: First Normal Form) <a class="header-anchor" href="#_1-第一范式-1nf-first-normal-form" aria-label="Permalink to &quot;1. 第一范式 (1NF: First Normal Form)&quot;">​</a></h3><p><strong>定义</strong>：一个关系（表）中的所有属性（列）都是<strong>原子性的</strong>，不可再分。这意味着每个字段都应该只包含一个值，而不是一组值或多个值的组合。 <img src="/assets/Pastedimage20250731110457.C9B6YHgY.png" alt=""></p><h3 id="_2-第二范式-2nf-second-normal-form" tabindex="-1">2. 第二范式 (2NF: Second Normal Form) <a class="header-anchor" href="#_2-第二范式-2nf-second-normal-form" aria-label="Permalink to &quot;2. 第二范式 (2NF: Second Normal Form)&quot;">​</a></h3><p><strong>定义</strong>：</p><ul><li><strong>满足1NF</strong>。</li><li><strong>所有的非主属性都必须完全依赖于主键</strong>。也就是说，如果主键是复合主键（由多个列组成），那么任何非主属性都不能只依赖于主键中的一部分。</li></ul><p><img src="/assets/Pastedimage20250731111121.CtXuTIqE.png" alt=""></p><h3 id="_3-第三范式-3nf-third-normal-form" tabindex="-1">3. 第三范式 (3NF: Third Normal Form) <a class="header-anchor" href="#_3-第三范式-3nf-third-normal-form" aria-label="Permalink to &quot;3. 第三范式 (3NF: Third Normal Form)&quot;">​</a></h3><p><strong>定义</strong>：</p><ul><li><strong>满足2NF</strong>。</li><li><strong>所有的非主属性都不能存在对主键的传递依赖</strong>。这意味着非主属性不能依赖于另一个非主属性。</li></ul><p><img src="/assets/Pastedimage20250731111420.BIIAEWIl.png" alt=""></p><h3 id="更高级的范式-了解即可" tabindex="-1">更高级的范式（了解即可） <a class="header-anchor" href="#更高级的范式-了解即可" aria-label="Permalink to &quot;更高级的范式（了解即可）&quot;">​</a></h3><p>除了1NF、2NF和3NF，还有一些更高级的范式：</p><ul><li><strong>BCNF (Boyce-Codd Normal Form)</strong>：比3NF更严格，要求所有决定因素（Determinant）都是候选键。</li><li><strong>4NF (Fourth Normal Form)</strong>：处理多值依赖。</li><li><strong>5NF (Fifth Normal Form)</strong>：处理连接依赖。</li></ul><h3 id="范式化的权衡" tabindex="-1">范式化的权衡 <a class="header-anchor" href="#范式化的权衡" aria-label="Permalink to &quot;范式化的权衡&quot;">​</a></h3><p>范式化是一个权衡的过程。虽然它能消除冗余和提高数据完整性，但有时也会引入复杂性：</p><ul><li><strong>优点</strong>：减少数据冗余、提高数据完整性、更容易进行数据维护。</li><li><strong>缺点</strong>：增加表的数量，可能导致查询需要更多的表连接（Join）操作，从而影响查询性能。</li></ul><p>因此，在设计数据库时，需要根据具体的业务需求和性能要求来决定范式化的程度。有时为了查询性能，会选择性地违反一些范式规则，进行<strong>反范式化（Denormalization）</strong>。</p><h1 id="sql规范" tabindex="-1">Sql规范 <a class="header-anchor" href="#sql规范" aria-label="Permalink to &quot;Sql规范&quot;">​</a></h1><h2 id="命名通用规则" tabindex="-1">命名通用规则 <a class="header-anchor" href="#命名通用规则" aria-label="Permalink to &quot;命名通用规则&quot;">​</a></h2><ul><li><strong>使用小写字母</strong>：避免大小写敏感问题</li><li><strong>使用下划线分隔</strong>：如 <code>user_info</code> 而不是 <code>userInfo</code></li><li><strong>名称要有意义</strong>：能够清楚表达用途</li><li><strong>保持简洁</strong>：避免过长的名称</li></ul><h2 id="_1-数据库命名示例" tabindex="-1">1. 数据库命名示例 <a class="header-anchor" href="#_1-数据库命名示例" aria-label="Permalink to &quot;1. 数据库命名示例&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 推荐格式</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">myapp_production    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 应用名_环境</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">company_erp         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 公司名_系统名</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">blog_system         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 功能描述</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 避免的命名</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MyDatabase          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 避免大写</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">database1           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 避免无意义数字</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">temp_db_2023        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 避免时间戳后缀</span></span></code></pre></div><h2 id="_2-表命名示例" tabindex="-1">2. 表命名示例 <a class="header-anchor" href="#_2-表命名示例" aria-label="Permalink to &quot;2. 表命名示例&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 使用复数名词</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">users               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 用户表</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">orders              </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 订单表</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">product_categories  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 产品分类表</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 关系表（多对多）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_roles          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 用户角色关联表</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">order_products      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 订单产品关联表</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 按业务模块划分 （表前缀)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_profiles       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 用户模块</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">order_items         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 订单模块</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">payment_records     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 支付模块</span></span></code></pre></div><h2 id="_3-字段命名示例" tabindex="-1">3. 字段命名示例 <a class="header-anchor" href="#_3-字段命名示例" aria-label="Permalink to &quot;3. 字段命名示例&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 主键</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">id                  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 主键ID</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 时间字段</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">created_at          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 创建时间</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">updated_at          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 更新时间</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deleted_at          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除时间（软删除）</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 常用业务字段</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_name           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 用户名</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">email_address       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 邮箱地址</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phone_number        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 电话号码</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">is_active           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 状态标识</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 布尔类型 (类型相关)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">is_deleted          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 是否删除</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">is_verified         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 是否验证</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">has_permission      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 是否有权限</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 数量相关 (类型相关)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">total_amount        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 总金额</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_count          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 项目数量</span></span></code></pre></div><h2 id="_4-索引命名规范" tabindex="-1">4. 索引命名规范 <a class="header-anchor" href="#_4-索引命名规范" aria-label="Permalink to &quot;4. 索引命名规范&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 主键索引</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pk_table_name       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 主键索引</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 唯一索引</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">uk_table_column     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- uk_users_email</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 普通索引</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">idx_table_column    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- idx_users_created_at</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 复合索引</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">idx_table_col1_col2 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- idx_orders_user_id_status</span></span></code></pre></div><h2 id="_5-约束命名规范" tabindex="-1">5. 约束命名规范 <a class="header-anchor" href="#_5-约束命名规范" aria-label="Permalink to &quot;5. 约束命名规范&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 外键约束</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fk_table_ref_table  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- fk_orders_user_id_users</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 检查约束</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ck_table_column     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- ck_users_age</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 唯一约束</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">uk_table_column     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- uk_users_username</span></span></code></pre></div><h1 id="数据库命令" tabindex="-1">数据库命令 <a class="header-anchor" href="#数据库命令" aria-label="Permalink to &quot;数据库命令&quot;">​</a></h1><h2 id="mysql" tabindex="-1">MySQL <a class="header-anchor" href="#mysql" aria-label="Permalink to &quot;MySQL&quot;">​</a></h2><h3 id="查询数据库" tabindex="-1">查询数据库 <a class="header-anchor" href="#查询数据库" aria-label="Permalink to &quot;查询数据库&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 登录后查看</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> username</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SHOW</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DATABASES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或者直接在命令行执行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> username</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;SHOW DATABASES;&quot;</span></span></code></pre></div><h3 id="创建数据库" tabindex="-1">创建数据库 <a class="header-anchor" href="#创建数据库" aria-label="Permalink to &quot;创建数据库&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> username</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CREATE DATABASE database_name;&quot;</span></span></code></pre></div><h3 id="删除数据库" tabindex="-1">删除数据库 <a class="header-anchor" href="#删除数据库" aria-label="Permalink to &quot;删除数据库&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> username</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;DROP DATABASE database_name;&quot;</span></span></code></pre></div><h3 id="修改数据库" tabindex="-1">修改数据库 <a class="header-anchor" href="#修改数据库" aria-label="Permalink to &quot;修改数据库&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 修改字符集等属性</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> username</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ALTER DATABASE database_name CHARACTER SET utf8mb4;&quot;</span></span></code></pre></div><h2 id="postgresql" tabindex="-1">PostgreSQL <a class="header-anchor" href="#postgresql" aria-label="Permalink to &quot;PostgreSQL&quot;">​</a></h2><h3 id="查询数据库-1" tabindex="-1">查询数据库 <a class="header-anchor" href="#查询数据库-1" aria-label="Permalink to &quot;查询数据库&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 列出所有数据库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">psql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> username</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或者登录后执行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">psql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> username</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \l</span></span></code></pre></div><h3 id="创建数据库-1" tabindex="-1">创建数据库 <a class="header-anchor" href="#创建数据库-1" aria-label="Permalink to &quot;创建数据库&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> username</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> database_name</span></span></code></pre></div><h3 id="删除数据库-1" tabindex="-1">删除数据库 <a class="header-anchor" href="#删除数据库-1" aria-label="Permalink to &quot;删除数据库&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dropdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> username</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> database_name</span></span></code></pre></div><h3 id="修改数据库-1" tabindex="-1">修改数据库 <a class="header-anchor" href="#修改数据库-1" aria-label="Permalink to &quot;修改数据库&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 修改数据库属性</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">psql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> username</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ALTER DATABASE database_name OWNER TO new_owner;&quot;</span></span></code></pre></div><h1 id="表curd" tabindex="-1">表CURD <a class="header-anchor" href="#表curd" aria-label="Permalink to &quot;表CURD&quot;">​</a></h1><h2 id="_1-创建表" tabindex="-1">1. 创建表 <a class="header-anchor" href="#_1-创建表" aria-label="Permalink to &quot;1. 创建表&quot;">​</a></h2><h3 id="基本语法" tabindex="-1">基本语法 <a class="header-anchor" href="#基本语法" aria-label="Permalink to &quot;基本语法&quot;">​</a></h3><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE TABLE table_name (</span></span>
<span class="line"><span>    column1 datatype [constraints],</span></span>
<span class="line"><span>    column2 datatype [constraints],</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>    [table_constraints]</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 创建用户表</span></span>
<span class="line"><span>CREATE TABLE users (</span></span>
<span class="line"><span>    id INT AUTO_INCREMENT PRIMARY KEY,</span></span>
<span class="line"><span>    username VARCHAR(50) NOT NULL UNIQUE,</span></span>
<span class="line"><span>    email VARCHAR(100) NOT NULL UNIQUE,</span></span>
<span class="line"><span>    password VARCHAR(255) NOT NULL,</span></span>
<span class="line"><span>    age INT DEFAULT 18 CHECK (age &gt;= 0 AND age &lt;= 150),</span></span>
<span class="line"><span>    gender ENUM(&#39;M&#39;, &#39;F&#39;, &#39;Other&#39;),</span></span>
<span class="line"><span>    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,</span></span>
<span class="line"><span>    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP --MySql特有: 时间戳字段的自动更新机制</span></span>
<span class="line"><span>);</span></span></code></pre></div><h3 id="数据类型" tabindex="-1">数据类型 <a class="header-anchor" href="#数据类型" aria-label="Permalink to &quot;数据类型&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 整数类型</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TINYINT</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      -- 1字节，-128到127</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SMALLINT</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     -- 2字节，-32768到32767</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MEDIUMINT    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 3字节，-8388608到8388607</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT/INTEGER</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  -- 4字节，-2147483648到2147483647</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BIGINT</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       -- 8字节，大整数</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 浮点类型</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FLOAT</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        -- 4字节单精度浮点数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DOUBLE       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 8字节双精度浮点数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DECIMAL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(M,D) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 精确的小数，M是总位数，D是小数位数</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 字符串类型</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n)      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 固定长度字符串，最大255字符</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n)   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 可变长度字符串，最大65535字符</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TEXT</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         -- 长文本数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MEDIUMTEXT   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 中等长度文本</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LONGTEXT     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 超长文本</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 日期时间类型</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DATE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         -- 日期格式：YYYY-MM-DD</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TIME</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         -- 时间格式：HH:MM:SS</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DATETIME</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     -- 日期时间：YYYY-MM-DD HH:MM:SS</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TIMESTAMP</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    -- 时间戳</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">YEAR</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         -- 年份</span></span></code></pre></div><h3 id="列约束" tabindex="-1">列约束 <a class="header-anchor" href="#列约束" aria-label="Permalink to &quot;列约束&quot;">​</a></h3><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- 基本约束</span></span>
<span class="line"><span>name VARCHAR(50) NOT NULL                       -- NOT NULL：非空约束</span></span>
<span class="line"><span>age INT DEFAULT 18                              -- DEFAULT：默认值</span></span>
<span class="line"><span>email VARCHAR(100) UNIQUE                       -- UNIQUE：唯一约束，字段值必须唯一</span></span>
<span class="line"><span>id INT PRIMARY KEY                              -- PRIMARY KEY：主键约束，唯一且非空</span></span>
<span class="line"><span>dept_id INT REFERENCES department(id)           -- REFERENCES：外键约束，引用其他表的字段</span></span>
<span class="line"><span>age INT CHECK (age &gt;= 0 AND age &lt;= 150)         -- CHECK：检查约束，满足条件才能插入 （MySQL不支持）</span></span>
<span class="line"><span>id INT AUTO_INCREMENT PRIMARY KEY               -- AUTO_INCREMENT：自增（MySQL）</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 表级约束</span></span>
<span class="line"><span>PRIMARY KEY (column1, column2)                  -- 联合主键约束</span></span>
<span class="line"><span>UNIQUE (column1, column2)                       -- 联合唯一约束</span></span>
<span class="line"><span>FOREIGN KEY (dept_id) REFERENCES department(id) -- 表级外键约束</span></span>
<span class="line"><span>CHECK (salary &gt;= 0 AND bonus &gt;= 0)              -- 表级检查约束</span></span></code></pre></div><h3 id="外键约束选项" tabindex="-1">外键约束选项 <a class="header-anchor" href="#外键约束选项" aria-label="Permalink to &quot;外键约束选项&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> orders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    user_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FOREIGN KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (user_id) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">REFERENCES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users(id)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        ON DELETE CASCADE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      -- 级联删除</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        ON</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CASCADE      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 级联更新</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- ON DELETE CASCADE：父表删除，子表对应记录也删除</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- ON DELETE SET NULL：父表删除，子表对应字段设为 NULL</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- ON DELETE RESTRICT：父表有子记录时不允许删除</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- ON DELETE NO ACTION：与 RESTRICT 类似，但在某些数据库中稍有区别</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- ON UPDATE CASCADE：父表更新主键，子表同步更新</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- ON UPDATE SET NULL：父表更新主键，子表设为 NULL</span></span></code></pre></div><h3 id="索引" tabindex="-1">索引 <a class="header-anchor" href="#索引" aria-label="Permalink to &quot;索引&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 创建表时直接定义索引</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> users</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,                           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 主键索引（自动创建）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    email </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UNIQUE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,                    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 唯一索引（自动创建）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    -- 在创建表时定义索引</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    INDEX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> idx_name (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),                        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 普通索引</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    INDEX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> idx_age (age),                          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 普通索引</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    INDEX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> idx_name_age (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, age),              </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 复合索引</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h2 id="_2-修改表" tabindex="-1">2. 修改表 <a class="header-anchor" href="#_2-修改表" aria-label="Permalink to &quot;2. 修改表&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 添加</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN phone </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);                    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 添加新字段</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN created_at </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TIMESTAMP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DEFAULT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT_TIMESTAMP; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 添加带默认值的字段</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CONSTRAINT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> uk_email </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UNIQUE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (email);         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 添加唯一约束</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CONSTRAINT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fk_dept </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FOREIGN KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (dept_id) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">REFERENCES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department(id); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 添加外键约束</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CONSTRAINT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chk_age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CHECK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 添加检查约束</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> SET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 添加非空约束</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN phone;                              </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除字段</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CONSTRAINT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> uk_email;                       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除约束</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN email </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除非空约束</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 修改</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">MODIFY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 修改字段类型和属性（MySQL）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 修改字段默认值（PostgreSQL/SQL Server）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users CHANGE COLUMN </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> username </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 修改字段名和类型（MySQL）</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 重命名</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users RENAME </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> customers;                            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 重命名表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users RENAME COLUMN </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> username;                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 重命名字段（PostgreSQL）</span></span></code></pre></div><h2 id="_3-删除表" tabindex="-1">3. 删除表 <a class="header-anchor" href="#_3-删除表" aria-label="Permalink to &quot;3. 删除表&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- DROP TABLE：删除表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;                                                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除表（如果存在则删除）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> IF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> EXISTS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;                                       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 如果表存在则删除（避免报错）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users, orders, products;                              </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 同时删除多个表</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- TRUNCATE TABLE：清空表数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TRUNCATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;                                             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 清空表数据，保留表结构</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TRUNCATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RESTART</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> IDENTITY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 清空数据并重置自增ID（PostgreSQL）</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- DELETE：删除表数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;                                               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除表中所有数据（逐行删除）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 按条件删除数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);                         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除指定ID的数据</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- DROP TABLE相关选项</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users CASCADE;                                        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 级联删除（删除被其他表引用的表）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users RESTRICT;                                       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 限制删除（如果有外键引用则禁止删除）</span></span></code></pre></div><h2 id="_4-查询表" tabindex="-1">4.查询表 <a class="header-anchor" href="#_4-查询表" aria-label="Permalink to &quot;4.查询表&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- SHOW语句：查看表信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW TABLES;                                                     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 显示所有表</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW TABLES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;user%&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 模糊查询表名</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;                                         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 显示创建表的SQL语句</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW COLUMNS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;                                         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 显示表的字段信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW FIELDS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;                                          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 显示表的字段信息（同上）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INDEX</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;                                           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 显示表的索引信息</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- DESCRIBE语句：查看表结构</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DESCRIBE users;                                                  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查看表结构</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;                                                      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查看表结构（简写）</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- INFORMATION_SCHEMA查询：查询元数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> INFORMATION_SCHEMA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TABLES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TABLE_NAME </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;users&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查询表元数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> INFORMATION_SCHEMA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">COLUMNS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TABLE_NAME </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;users&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查询字段元数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> INFORMATION_SCHEMA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">KEY_COLUMN_USAGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TABLE_NAME </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;users&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查询键约束信息</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> INFORMATION_SCHEMA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">REFERENTIAL_CONSTRAINTS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查询外键约束信息</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 系统表查询（不同数据库）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sys</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tables</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;users&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- SQL Server查询表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tablename </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pg_tables </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tablename </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;users&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- PostgreSQL查询表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sqlite_master </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;table&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;users&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- SQLite查询表</span></span></code></pre></div><h1 id="数据的增删改" tabindex="-1">数据的增删改 <a class="header-anchor" href="#数据的增删改" aria-label="Permalink to &quot;数据的增删改&quot;">​</a></h1><h2 id="_1-插入" tabindex="-1">1. 插入 <a class="header-anchor" href="#_1-插入" aria-label="Permalink to &quot;1. 插入&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 插入单行数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (id, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email, age) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;张三&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;zhangsan@example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 插入部分列据 （可以省略可为空或有默认值的列)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;王五&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;wangwu@example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);                          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 插入所有列数据</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 批量插入数据(MySQL特有)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (id, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email, age) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;赵六&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;zhaoliu@example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;孙七&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;sunqi@example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">27</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;周八&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;zhouba@example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">29</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);                                               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 一次插入多行数据</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 插入默认值和NULL值</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (id, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email, age) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;钱十一&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DEFAULT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">31</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 使用默认值</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (id, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email, age) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;孙十二&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);                  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 插入NULL值</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 插入查询结果</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> backup_users (id, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email, age)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email, age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 从其他表查询并插入</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 条件插入（避免重复）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT IGNORE INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (id, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;新张三&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;new@example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- MySQL忽略重复键错误</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (id, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;新张三&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;new@example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CONFLICT (id) DO NOTHING;                                                             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- PostgreSQL忽略冲突</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 存在则更新，不存在则插入（UPSERT）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (id, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email, age) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;张三更新&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;new@example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">26</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DUPLICATE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">KEY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UPDATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), email </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(email);                      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- MySQL的ON DUPLICATE KEY UPDATE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (id, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email, age) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;张三更新&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;new@example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">26</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CONFLICT (id) DO </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> SET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> EXCLUDED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> EXCLUDED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">email</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- PostgreSQL的ON CONFLICT</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 使用SET语法插入（MySQL特有）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;MySQL用户&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;mysql@example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- MySQL的SET语法</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 返回插入的数据（PostgreSQL特有）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;返回用户&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;return@example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RETURNING id, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                                                      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 插入后返回指定字段</span></span></code></pre></div><h2 id="_2-更新" tabindex="-1">2. 更新 <a class="header-anchor" href="#_2-更新" aria-label="Permalink to &quot;2. 更新&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 基本更新</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;John&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;John&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 表达式更新</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> products </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> category </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;electronics&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> score </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> score </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> active </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 条件更新</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CASE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    WHEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> score </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 90</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> THEN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;A&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    WHEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> score </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> THEN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;B&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ELSE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;C&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">END</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> active </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 多表关联更新</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> departments d </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dept_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dept_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">active</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 安全设置</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SQL_SAFE_UPDATES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 启用安全模式</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;processed&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 限制更新条数</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 重要提醒：始终使用WHERE条件，避免全表更新！</span></span></code></pre></div><h2 id="_3-删除" tabindex="-1">3. 删除 <a class="header-anchor" href="#_3-删除" aria-label="Permalink to &quot;3. 删除&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;                                               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除表中所有数据（逐行删除）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 按条件删除数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);                         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除指定ID的数据</span></span></code></pre></div><h1 id="sql查询语句详解" tabindex="-1">SQL查询语句详解 <a class="header-anchor" href="#sql查询语句详解" aria-label="Permalink to &quot;SQL查询语句详解&quot;">​</a></h1><h2 id="_1-基本查询语句" tabindex="-1">1. 基本查询语句 <a class="header-anchor" href="#_1-基本查询语句" aria-label="Permalink to &quot;1. 基本查询语句&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 基础语句</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees;                                                     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查询所有列</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> first_name, last_name, salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees;                         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查询特定列</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> first_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 姓名, salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 薪资 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees;                    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查询并重命名列</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 条件查询</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 等于</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 不等于</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 不等于</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 大于、小于</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 大于、小于</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 范围查询</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> email </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">IS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 空值判断</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> email </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">IS NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 空值判断</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;IT&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- AND运算符</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;IT&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> OR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;HR&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- OR运算符</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;IT&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- NOT运算符</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;IT&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;HR&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Finance&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- IN操作符</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> IN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;IT&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;HR&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- NOT IN操作符</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- LIKI模糊查询</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> first_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;J%&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 匹配以某字符开头</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> first_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;%n&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 匹配以某字符结尾</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> first_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;%oh%&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 匹配包含某字符</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> first_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;J_hn&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 匹配单个字符</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> first_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;J%&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- NOT LIKE</span></span></code></pre></div><h2 id="_2-排序-分页-分组" tabindex="-1">2. 排序，分页，分组 <a class="header-anchor" href="#_2-排序-分页-分组" aria-label="Permalink to &quot;2. 排序，分页，分组&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- ORDER BY排序</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> salary;                                      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 升序排序（默认）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 降序排序</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 多列排序</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> first_name, last_name, salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 按表达式排序</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- LIMIT和OFFSET（分页）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 限制返回行数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OFFSET </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 跳过前几行并限制返回数量</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- MySQL简写语法</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- GROUP BY分组</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/*</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">基础语法：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	SELECT column1, aggregate_function(column2)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	FROM table_name</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	WHERE condition</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	GROUP BY column1, column2, ...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	HAVING condition</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	ORDER BY column_name;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">常用聚合函数：COUNT、SUM、AVERAGE、MAX、MIN</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">*/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employee_count </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 按部门分组统计人数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(salary) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> avg_salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 按部门分组计算平均薪资</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department, gender, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department, gender;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 多列分组</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- HAVING子句：用于过滤分组结果</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(salary) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> avg_salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">HAVING</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(salary) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 6000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h2 id="_3-join连接查询" tabindex="-1">3. JOIN连接查询 <a class="header-anchor" href="#_3-join连接查询" aria-label="Permalink to &quot;3. JOIN连接查询&quot;">​</a></h2><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- FROM employees e 表别名，省略as</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- INNER JOIN（内连接） 只返回两个表中都有匹配记录的数据    默认join就是inner join</span></span>
<span class="line"><span>SELECT e.first_name, e.last_name, d.department_name</span></span>
<span class="line"><span>FROM employees e</span></span>
<span class="line"><span>INNER JOIN departments d ON e.department_id = d.department_id;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- LEFT JOIN（左连接） 返回左表（employees）的所有记录，以及右表中匹配的记录 </span></span>
<span class="line"><span>-- 如果右表有多行匹配，就会产生多行结果（左边这一行会被重复，和右边的多行一一对应）</span></span>
<span class="line"><span>SELECT e.first_name, e.last_name, d.department_name</span></span>
<span class="line"><span>FROM employees e</span></span>
<span class="line"><span>LEFT JOIN departments d ON e.department_id = d.department_id;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- RIGHT JOIN（右连接） 返回右表（departments）的所有记录，以及左表中匹配的记录</span></span>
<span class="line"><span>SELECT e.first_name, e.last_name, d.department_name</span></span>
<span class="line"><span>FROM employees e</span></span>
<span class="line"><span>RIGHT JOIN departments d ON e.department_id = d.department_id;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- FULL OUTER JOIN（全外连接） 返回两个表中的所有记录</span></span>
<span class="line"><span>SELECT e.first_name, e.last_name, d.department_name</span></span>
<span class="line"><span>FROM employees e</span></span>
<span class="line"><span>FULL OUTER JOIN departments d ON e.department_id = d.department_id;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 自连接 同一张表与自己连接</span></span>
<span class="line"><span>SELECT e1.first_name, e2.first_name as manager_name</span></span>
<span class="line"><span>FROM employees e1</span></span>
<span class="line"><span>LEFT JOIN employees e2 ON e1.manager_id = e2.employee_id;</span></span></code></pre></div><h2 id="_4-子查询" tabindex="-1">4. 子查询 <a class="header-anchor" href="#_4-子查询" aria-label="Permalink to &quot;4. 子查询&quot;">​</a></h2><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- 按子查询，例(SELECT AVG(salary) FROM employees) 返回值分类</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 标量子查询：子查询返回单个值</span></span>
<span class="line"><span>SELECT first_name, salary</span></span>
<span class="line"><span>FROM employees</span></span>
<span class="line"><span>WHERE salary &gt; (SELECT AVG(salary) FROM employees);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 行子查询：子查询返回一行多列的数据</span></span>
<span class="line"><span>SELECT first_name, last_name</span></span>
<span class="line"><span>FROM employees</span></span>
<span class="line"><span>WHERE (first_name, last_name) = (</span></span>
<span class="line"><span>    SELECT first_name, last_name </span></span>
<span class="line"><span>    FROM employees </span></span>
<span class="line"><span>    WHERE employee_id = 100</span></span>
<span class="line"><span>); </span></span>
<span class="line"><span>-- 两个查询都在同一个表，此处子查询可直接优化成 WHERE employee_id = 100;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 列子查询：子查询返回一列多个值</span></span>
<span class="line"><span>-- 主查询筛选通常是IN或使用ANY与ALL关键词</span></span>
<span class="line"><span>-- 子查询IN中NULL值不能被筛选出来，NOT IN中如果有NULL值查询不出任何数据</span></span>
<span class="line"><span>SELECT first_name, last_name</span></span>
<span class="line"><span>FROM employees</span></span>
<span class="line"><span>WHERE department_id IN (</span></span>
<span class="line"><span>    SELECT department_id </span></span>
<span class="line"><span>    FROM departments </span></span>
<span class="line"><span>    WHERE location = &#39;New York&#39;</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span>-- 两个查询在不同表，此处可优化为 JOIN departments d ON e.department_id = d.department_id WHERE d.location = &#39;New York&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 表子查询：子查询返回一个完整的表（临时视图）</span></span>
<span class="line"><span>SELECT emp_name, salary</span></span>
<span class="line"><span>FROM (</span></span>
<span class="line"><span>    SELECT first_name || &#39; &#39; || last_name as emp_name, salary</span></span>
<span class="line"><span>    FROM employees</span></span>
<span class="line"><span>) emp_salary</span></span>
<span class="line"><span>WHERE salary &gt; 5000; -- 此处可优化直接在主查询筛选</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 相关子查询</span></span>
<span class="line"><span>-- 子查询必须依赖主查询的数据才能执行</span></span>
<span class="line"><span>SELECT c.course_id, c.course_name</span></span>
<span class="line"><span>FROM courses c</span></span>
<span class="line"><span>WHERE EXISTS (</span></span>
<span class="line"><span>    SELECT 1</span></span>
<span class="line"><span>    FROM student_course sc</span></span>
<span class="line"><span>    WHERE sc.course_id = c.course_id</span></span>
<span class="line"><span>);</span></span></code></pre></div><h2 id="_5-union、case" tabindex="-1">5. UNION、CASE <a class="header-anchor" href="#_5-union、case" aria-label="Permalink to &quot;5. UNION、CASE&quot;">​</a></h2><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- UNION（去重） 合并两个查询结果集、自动去除重复的记录、结果按默认顺序排序（除非指定ORDER BY）</span></span>
<span class="line"><span>SELECT first_name FROM employees</span></span>
<span class="line"><span>UNION</span></span>
<span class="line"><span>SELECT customer_name FROM customers;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- UNION ALL（不去重） 合并结果集的同时保留重复的</span></span>
<span class="line"><span>SELECT first_name FROM employees</span></span>
<span class="line"><span>UNION ALL</span></span>
<span class="line"><span>SELECT customer_name FROM customers;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- CASE语句</span></span>
<span class="line"><span>SELECT first_name, salary,</span></span>
<span class="line"><span>CASE </span></span>
<span class="line"><span>    WHEN salary &gt; 8000 THEN &#39;高薪&#39;</span></span>
<span class="line"><span>    WHEN salary &gt; 5000 THEN &#39;中薪&#39;</span></span>
<span class="line"><span>    ELSE &#39;低薪&#39;</span></span>
<span class="line"><span>END as salary_level</span></span>
<span class="line"><span>FROM employees;</span></span></code></pre></div><h2 id="_6-复杂查询示例" tabindex="-1">6. 复杂查询示例 <a class="header-anchor" href="#_6-复杂查询示例" aria-label="Permalink to &quot;6. 复杂查询示例&quot;">​</a></h2><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- 查询2020年以后入职的员工中，统计各部门员工数量、平均工资和最高工资，筛选出员工数超过5人的部门，按平均工资降序排列显示前10个部门</span></span>
<span class="line"><span>SELECT </span></span>
<span class="line"><span>    d.department_name,</span></span>
<span class="line"><span>    COUNT(e.employee_id) as employee_count,</span></span>
<span class="line"><span>    AVG(e.salary) as avg_salary,</span></span>
<span class="line"><span>    MAX(e.salary) as max_salary</span></span>
<span class="line"><span>FROM employees e</span></span>
<span class="line"><span>INNER JOIN departments d ON e.department_id = d.department_id</span></span>
<span class="line"><span>WHERE e.hire_date &gt;= &#39;2020-01-01&#39;</span></span>
<span class="line"><span>GROUP BY d.department_name</span></span>
<span class="line"><span>HAVING COUNT(e.employee_id) &gt; 5</span></span>
<span class="line"><span>ORDER BY avg_salary DESC</span></span>
<span class="line"><span>LIMIT 10;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 查询所有在职员工的基本信息、所在部门及工资与全公司平均工资的对比情况，按工资降序排列</span></span>
<span class="line"><span>SELECT </span></span>
<span class="line"><span>    e.first_name,</span></span>
<span class="line"><span>    e.last_name,</span></span>
<span class="line"><span>    e.salary,</span></span>
<span class="line"><span>    d.department_name,</span></span>
<span class="line"><span>    CASE </span></span>
<span class="line"><span>        WHEN e.salary &gt; (SELECT AVG(salary) FROM employees) </span></span>
<span class="line"><span>        THEN &#39;高于平均&#39;</span></span>
<span class="line"><span>        ELSE &#39;低于平均&#39;</span></span>
<span class="line"><span>    END as salary_status</span></span>
<span class="line"><span>FROM employees e</span></span>
<span class="line"><span>LEFT JOIN departments d ON e.department_id = d.department_id</span></span>
<span class="line"><span>WHERE e.status = &#39;ACTIVE&#39;</span></span>
<span class="line"><span>ORDER BY e.salary DESC;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 3.查询班级人数高于 各班级平均人数的 班级编号，班级名称</span></span>
<span class="line"><span>-- 思路：</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span>1. 先查询出各个班级的人数 COUNT</span></span>
<span class="line"><span>2. 通过子查询对第1步的查询进行求平均 子查询+AVG</span></span>
<span class="line"><span>3. 学生表和班级表关联，对班级ID和班级名分组，计算人数COUNT</span></span>
<span class="line"><span>4. 第3步利用HAVING语句，对COUNT结果与第2步数据比较</span></span>
<span class="line"><span>*/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>select CLASS_ID,CLASS_NAME</span></span>
<span class="line"><span>from SCLASS s</span></span>
<span class="line"><span>	join student s2 on(s.CLASS_ID = s2.STU_CLASS)</span></span>
<span class="line"><span>group by CLASS_ID</span></span>
<span class="line"><span>having count(STU_NAME) &gt; (</span></span>
<span class="line"><span>	select avg(cnt)</span></span>
<span class="line"><span>	from (</span></span>
<span class="line"><span>		select CLASS_ID,count(STU_NAME) as cnt</span></span>
<span class="line"><span>		from SCLASS s</span></span>
<span class="line"><span>			join student s2 on(s.CLASS_ID = s2.STU_CLASS)</span></span>
<span class="line"><span>		group by CLASS_ID</span></span>
<span class="line"><span>	) t</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 6.查询与Lu同班级，平均分高于他的其他学员的信息</span></span>
<span class="line"><span>-- 思路：</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span>1. 求得各个学生的平均分</span></span>
<span class="line"><span>2. 学生表与第1步关联，得到学生信息+学生平均分</span></span>
<span class="line"><span>3. where中学生的班级与Lu同班级 子查询1</span></span>
<span class="line"><span>4. where中学生平均分 高于 Lu的平均分 子查询2</span></span>
<span class="line"><span>*/</span></span>
<span class="line"><span>select *</span></span>
<span class="line"><span>from student s</span></span>
<span class="line"><span>where STU_ID in (</span></span>
<span class="line"><span>	select s.STU_ID</span></span>
<span class="line"><span>	from student s</span></span>
<span class="line"><span>		join stu_course sc on(s.STU_ID = sc.STU_ID)</span></span>
<span class="line"><span>	where s.STU_CLASS = (</span></span>
<span class="line"><span>		select STU_CLASS</span></span>
<span class="line"><span>		from STUDENT</span></span>
<span class="line"><span>		where STU_NAME = &#39;lu&#39;</span></span>
<span class="line"><span>	)</span></span>
<span class="line"><span>	group by s.STU_ID,s.STU_CLASS</span></span>
<span class="line"><span>	having avg(SCORE) &gt; (</span></span>
<span class="line"><span>		select avg(SCORE)</span></span>
<span class="line"><span>		from STUDENT st</span></span>
<span class="line"><span>		join stu_course sct on(st.STU_ID = sct.STU_ID)</span></span>
<span class="line"><span>		where st.STU_NAME = &#39;lu&#39;</span></span>
<span class="line"><span>	)</span></span>
<span class="line"><span>);</span></span></code></pre></div><h2 id="_7-性能优化建议" tabindex="-1">7. 性能优化建议 <a class="header-anchor" href="#_7-性能优化建议" aria-label="Permalink to &quot;7. 性能优化建议&quot;">​</a></h2><ol><li><strong>使用索引</strong>：在经常查询的列上创建索引</li><li><strong>避免SELECT</strong>：只选择需要的列</li><li><strong>合理使用WHERE</strong>：尽早过滤数据</li><li><strong>避免在WHERE中使用函数</strong>：可能导致索引失效</li><li><strong>使用EXISTS替代IN</strong>：在某些情况下性能更好</li><li><strong>合理使用LIMIT</strong>：避免返回大量数据</li></ol><h1 id="其他高级功能" tabindex="-1">其他高级功能 <a class="header-anchor" href="#其他高级功能" aria-label="Permalink to &quot;其他高级功能&quot;">​</a></h1><h2 id="索引-index" tabindex="-1">索引(INDEX) <a class="header-anchor" href="#索引-index" aria-label="Permalink to &quot;索引(INDEX)&quot;">​</a></h2><h3 id="概念" tabindex="-1">概念 <a class="header-anchor" href="#概念" aria-label="Permalink to &quot;概念&quot;">​</a></h3><p><strong>索引</strong> = 数据库的&quot;目录&quot;，用于快速查找数据</p><ul><li><strong>原理</strong>：通过B+树等数据结构，建立列值到数据行的映射</li><li><strong>代价</strong>：占用存储空间，降低写入性能</li></ul><p><strong>核心策略</strong>：每表控制5-6个索引以内，优先为高选择性、高频查询的列建索引，复合索引要把最常用的列放前面。根据业务场景权衡读写性能和存储成本，避免盲目建索引和重复索引，定期清理无用索引，做到&quot;该建则建，该删则删&quot;。</p><h3 id="索引类型" tabindex="-1">索引类型 <a class="header-anchor" href="#索引类型" aria-label="Permalink to &quot;索引类型&quot;">​</a></h3><ul><li>按结构分类 <ul><li><strong>B+树索引</strong>：支持范围查询、排序 （最常用）</li><li><strong>哈希索引</strong>：等值查询快(O(1)) （精确匹配）</li><li><strong>位图索引</strong>：存储小，适合组合查询 （低基数列）</li></ul></li><li>按功能分类 <ul><li><strong>主键索引</strong>：自动创建，唯一标识</li><li><strong>唯一索引</strong>：保证列值唯一</li><li><strong>普通索引</strong>：基本索引类型</li><li><strong>复合索引</strong>：多个列组合</li><li><strong>全文索引</strong>：文本内容搜索</li></ul></li></ul><h3 id="创建语法" tabindex="-1">创建语法 <a class="header-anchor" href="#创建语法" aria-label="Permalink to &quot;创建语法&quot;">​</a></h3><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- 创建表时定义</span></span>
<span class="line"><span>CREATE TABLE users (</span></span>
<span class="line"><span>    id INT PRIMARY KEY,</span></span>
<span class="line"><span>    name VARCHAR(50),</span></span>
<span class="line"><span>    INDEX idx_name (name)</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 单独创建索引</span></span>
<span class="line"><span>CREATE INDEX idx_name ON users(name);</span></span>
<span class="line"><span>CREATE UNIQUE INDEX idx_email ON users(email);</span></span>
<span class="line"><span>CREATE INDEX idx_name_age ON users(name, age); -- 复合索引</span></span></code></pre></div><h3 id="优化原则" tabindex="-1">优化原则 <a class="header-anchor" href="#优化原则" aria-label="Permalink to &quot;优化原则&quot;">​</a></h3><ul><li>什么时候建索引 <ul><li>经常在WHERE中出现的列</li><li>经常用于JOIN的列</li><li>经常用于ORDER BY的列</li><li>高选择性列（值分布广）</li></ul></li><li>什么时候不建索引 <ul><li>数据量小的表（&lt; 1000行）</li><li>经常修改的列</li><li>低选择性列（如性别）</li><li>不在查询条件中的列</li></ul></li></ul><h3 id="索引使用" tabindex="-1">索引使用 <a class="header-anchor" href="#索引使用" aria-label="Permalink to &quot;索引使用&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INDEX</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> idx_a_b_c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ON</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a, b, c);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 能使用索引的查询 （自动使用）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 不能使用索引 </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 使用函数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> YEAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  -- ❌</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;2023-01-01&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;2024-01-01&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  -- ✅</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 类型转换</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> phone </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 123456789</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  -- ❌</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> phone </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;123456789&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  -- ✅</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 使用模糊查询</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;%John%&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  -- ❌</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;John%&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   -- ✅</span></span></code></pre></div><h3 id="性能监控" tabindex="-1">性能监控 <a class="header-anchor" href="#性能监控" aria-label="Permalink to &quot;性能监控&quot;">​</a></h3><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- 查看执行计划</span></span>
<span class="line"><span>EXPLAIN SELECT * FROM users WHERE name = &#39;John&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 查看索引信息</span></span>
<span class="line"><span>SHOW INDEX FROM users;</span></span></code></pre></div><h2 id="函数" tabindex="-1">函数 <a class="header-anchor" href="#函数" aria-label="Permalink to &quot;函数&quot;">​</a></h2><h3 id="函数分类" tabindex="-1">函数分类 <a class="header-anchor" href="#函数分类" aria-label="Permalink to &quot;函数分类&quot;">​</a></h3><ul><li><strong>聚合函数</strong>：对一组值进行计算并返回单个结果值的函数，它们通常与GROUP BY子句一起使用，用于对数据进行分组统计</li><li><strong>标量函数</strong>：对单个值进行操作并返回单个值的函数，通常用于数据转换和计算。标量函数是<strong>逐行处理</strong>数据的。</li><li><strong>分析函数</strong>：用于执行复杂分析计算的函数，支持窗口操作和排名统计</li><li><strong>转换函数</strong>：用于数据类型转换和格式转换的函数，实现不同数据格式间的相互转换</li><li><strong>系统函数</strong>：提供系统信息和元数据访问的函数，用于获取数据库系统状态和配置信息</li><li><strong>自定义函数</strong></li></ul><h3 id="_1-聚合函数" tabindex="-1">1. 聚合函数 <a class="header-anchor" href="#_1-聚合函数" aria-label="Permalink to &quot;1. 聚合函数&quot;">​</a></h3><p>常用函数：<code>COUNT()</code>、<code>SUM()</code>、<code>AVG()</code>、<code>MAX()/MIN()</code></p><h3 id="_2-标量函数" tabindex="-1">2. 标量函数 <a class="header-anchor" href="#_2-标量函数" aria-label="Permalink to &quot;2. 标量函数&quot;">​</a></h3><h4 id="常用字符串函数" tabindex="-1">常用字符串函数 <a class="header-anchor" href="#常用字符串函数" aria-label="Permalink to &quot;常用字符串函数&quot;">​</a></h4><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 长度和大小写</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LENGTH</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 返回字符串长度</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> UPPER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);                  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 转大写：HELLO</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LOWER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;HELLO&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);                  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 转小写：hello</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> INITCAP(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hello world&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 首字母大写（Oracle）</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 截取和连接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> SUBSTRING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 截取子串：Hello</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LEFT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 左边5个字符：Hello</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> RIGHT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 右边5个字符：World</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CONCAT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39; &#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 连接字符串</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Hello&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39; &#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- Oracle连接符</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 去除空格和替换</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> TRIM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;  Hello  &#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 去除两端空格</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LTRIM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;  Hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);                </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 去除左端空格</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> RTRIM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello  &#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);                </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 去除右端空格</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> REPLACE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;SQL&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 替换</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查找和定位</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> POSITION(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;World&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> IN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查找位置</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LOCATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查找位置（MySQL）</span></span></code></pre></div><h4 id="数学运算函数" tabindex="-1">数学运算函数 <a class="header-anchor" href="#数学运算函数" aria-label="Permalink to &quot;数学运算函数&quot;">​</a></h4><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 基本数学函数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ABS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 绝对值：10</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CEIL(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 向上取整：5</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> FLOOR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 向下取整：4</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ROUND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">567</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 四舍五入到小数点后2位：4.57</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TRUNCATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">567</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 截断到小数点后2位：4.56 (MySQL)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 幂运算和根运算</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> POWER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 2的3次方：8</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> SQRT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 平方根：4</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> EXP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);              </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- e的1次方</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LOG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 自然对数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LOG10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 以10为底的对数：2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 三角函数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> SIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 正弦值</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> COS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);              </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 余弦值</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> TAN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 正切值</span></span></code></pre></div><h4 id="日期函数" tabindex="-1">日期函数 <a class="header-anchor" href="#日期函数" aria-label="Permalink to &quot;日期函数&quot;">​</a></h4><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 当前日期时间</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT_DATE;        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 当前日期</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT_TIME;        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 当前时间</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT_TIMESTAMP;   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 当前日期时间戳</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- MySQL当前时间</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 日期提取</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> YEAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-12-25&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 年份：2023</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MONTH</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-12-25&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 月份：12</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DAY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-12-25&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 日期：25</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> HOUR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;14:30:00&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 小时：14</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> MINUTE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;14:30:00&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 分钟：30</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> SECOND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;14:30:45&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 秒：45</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 日期加减</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DATE_ADD(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-12-25&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, INTERVAL </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DAY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 加7天</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DATE_SUB(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-12-25&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, INTERVAL </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> MONTH</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 减1个月</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ADD_MONTHS(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-12-25&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 加3个月（Oracle）</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 日期差值</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DATEDIFF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-12-31&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-12-25&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 天数差：6</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TIMESTAMPDIFF(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">YEAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2020-01-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-12-25&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 年数差</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 日期格式化</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATE_FORMAT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-12-25&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;%Y年%m月%d日&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 格式化（MySQL）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TO_CHAR(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SYSDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;YYYY年MM月DD日&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DUAL;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 格式化（Oracle）</span></span></code></pre></div><h4 id="null处理函数" tabindex="-1">NULL处理函数 <a class="header-anchor" href="#null处理函数" aria-label="Permalink to &quot;NULL处理函数&quot;">​</a></h4><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- COALESCE：返回第一个非NULL值</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> COALESCE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(commission, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> actual_commission </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- NULLIF：如果两个值相等返回NULL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULLIF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(salary, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> safe_salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- ISNULL/CASE处理</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ISNULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(commission, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> commission_value  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- SQL Server FROM employees;</span></span></code></pre></div><h3 id="_3-分析函数-窗口函数" tabindex="-1">3. 分析函数（窗口函数） <a class="header-anchor" href="#_3-分析函数-窗口函数" aria-label="Permalink to &quot;3. 分析函数（窗口函数）&quot;">​</a></h3><h4 id="排名函数" tabindex="-1">排名函数 <a class="header-anchor" href="#排名函数" aria-label="Permalink to &quot;排名函数&quot;">​</a></h4><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- ROW_NUMBER：行号</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, salary,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       ROW_NUMBER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> row_num</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- RANK：排名（相同值排名相同，跳过后续排名）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, salary,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rank_num</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- DENSE_RANK：密集排名（不跳过排名）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, salary,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       DENSE_RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_rank_num</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees;</span></span></code></pre></div><h4 id="窗口聚合函数" tabindex="-1">窗口聚合函数 <a class="header-anchor" href="#窗口聚合函数" aria-label="Permalink to &quot;窗口聚合函数&quot;">​</a></h4><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- 累计求和</span></span>
<span class="line"><span>SELECT name, salary,</span></span>
<span class="line"><span>       SUM(salary) OVER (ORDER BY salary ROWS UNBOUNDED PRECEDING) as cum_sum</span></span>
<span class="line"><span>FROM employees;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 移动平均</span></span>
<span class="line"><span>SELECT date, sales,</span></span>
<span class="line"><span>       AVG(sales) OVER (ORDER BY date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) as moving_avg</span></span>
<span class="line"><span>FROM daily_sales;</span></span></code></pre></div><h3 id="_4-转换函数" tabindex="-1">4. 转换函数 <a class="header-anchor" href="#_4-转换函数" aria-label="Permalink to &quot;4. 转换函数&quot;">​</a></h3><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- 显式类型转换</span></span>
<span class="line"><span>SELECT CAST(&#39;123&#39; AS INTEGER);          -- 字符串转整数</span></span>
<span class="line"><span>SELECT CONVERT(INT, &#39;123&#39;);             -- SQL Server转换</span></span>
<span class="line"><span>SELECT TO_NUMBER(&#39;123.45&#39;) FROM DUAL;   -- Oracle转换</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 日期转换</span></span>
<span class="line"><span>SELECT STR_TO_DATE(&#39;2023-12-25&#39;, &#39;%Y-%m-%d&#39;);  -- MySQL字符串转日期</span></span>
<span class="line"><span>SELECT TO_DATE(&#39;2023-12-25&#39;, &#39;YYYY-MM-DD&#39;) FROM DUAL;  -- Oracle转换</span></span></code></pre></div><h3 id="_5-系统函数" tabindex="-1">5. 系统函数 <a class="header-anchor" href="#_5-系统函数" aria-label="Permalink to &quot;5. 系统函数&quot;">​</a></h3><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- 获取当前系统时间</span></span>
<span class="line"><span>SELECT GETDATE() AS CurrentTime;</span></span>
<span class="line"><span>SELECT SYSDATE FROM DUAL; -- Oracle</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 获取当前用户名</span></span>
<span class="line"><span>SELECT USER_NAME() AS CurrentUser;</span></span>
<span class="line"><span>SELECT USER FROM DUAL; -- Oracle</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 获取当前数据库名称</span></span>
<span class="line"><span>SELECT DB_NAME() AS DatabaseName;</span></span>
<span class="line"><span>SELECT DATABASE() FROM DUAL; -- MySQL</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 获取数据库版本信息</span></span>
<span class="line"><span>SELECT @@VERSION AS VersionInfo;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 获取数据库对象的标识符</span></span>
<span class="line"><span>SELECT OBJECT_ID(&#39;TableName&#39;) AS TableID;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 获取服务器名称</span></span>
<span class="line"><span>SELECT @@SERVERNAME AS ServerName;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 获取连接的会话ID</span></span>
<span class="line"><span>SELECT @@SPID AS SessionID;</span></span></code></pre></div><h3 id="_6-自定义函数" tabindex="-1">6. 自定义函数 <a class="header-anchor" href="#_6-自定义函数" aria-label="Permalink to &quot;6. 自定义函数&quot;">​</a></h3><h4 id="语法格式" tabindex="-1">语法格式 <a class="header-anchor" href="#语法格式" aria-label="Permalink to &quot;语法格式&quot;">​</a></h4><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [DEFINER = { user | CURRENT_USER }]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FUNCTION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> functionName (varName varType [, ...])</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    RETURNS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> returnVarType</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [characteristic ...]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    routine_body</span></span></code></pre></div><ul><li>functionName：函数名，同MySQL内置函数一样，大小写不敏感</li><li>varName: 形参名</li><li>varType: 形参类型，其与varName配对使用。形参数量不限( <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.312ex;" xmlns="http://www.w3.org/2000/svg" width="3.52ex" height="1.819ex" role="img" focusable="false" viewBox="0 -666 1555.8 804" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2265" d="M83 616Q83 624 89 630T99 636Q107 636 253 568T543 431T687 361Q694 356 694 346T687 331Q685 329 395 192L107 56H101Q83 58 83 76Q83 77 83 79Q82 86 98 95Q117 105 248 167Q326 204 378 228L626 346L360 472Q291 505 200 548Q112 589 98 597T83 616ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(1055.8,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≥</mo><mn>0</mn></math></mjx-assistive-mml></mjx-container>)</li><li>returnVarType: 返回值类型。函数<strong>必须有且只能有一个</strong>返回值</li><li>characteristic：函数特性，下将详述</li><li>routine_body：函数体。函数体中必须含有 <strong>return</strong> 语句，当函数体为复合结构时，需要使用begin ... end 语句</li><li>characteristic 可选值 <ul><li><code>LANGUAGE SQL</code> 函数语言（目前仅支持 SQL）</li><li><code>[NOT] DETERMINISTIC</code> 是否确定性函数（相同输入是否一定返回相同结果）</li><li><code>CONTAINS SQL``NO SQL``READS SQL DATA``MODIFIES SQL DATA</code> SQL 使用限制，默认为<code>contains sql</code>  - <code>contains sql</code>意为函数体包含sql语句，但不包含读写数据的sql语句； <ul><li><code>no sql</code>意为函数体不包含sql语句；</li><li><code>reads sql data</code>意为函数体包含读数据sql语句；</li><li><code>modifies sql data</code>意为函数体包含写数据的sql语句。</li></ul></li><li><code>SQL SECURITY {DEFINER | INVOKER}</code> 指明谁有权限执行该函数，默认为<code>definer</code><ul><li><code>definer</code>意为只有定义者才能执行；</li><li><code>invoker</code>意为拥有权限的调用者可以执行</li></ul></li><li><code>COMMENT &#39;...&#39;</code> 函数注释</li></ul></li></ul><h4 id="变量和流程控制" tabindex="-1">变量和流程控制 <a class="header-anchor" href="#变量和流程控制" aria-label="Permalink to &quot;变量和流程控制&quot;">​</a></h4><h5 id="局部变量-declare" tabindex="-1">局部变量（<code>DECLARE</code>） <a class="header-anchor" href="#局部变量-declare" aria-label="Permalink to &quot;局部变量（`DECLARE`）&quot;">​</a></h5><ul><li>作用域：<code>BEGIN ... END</code> 块内</li><li>默认初值为 <code>NULL</code>，可使用 <code>DEFAULT</code> 设置初值</li><li>赋值 <ul><li><code>SET</code> 语句（= 或 :=）</li><li><code>SELECT ... INTO</code></li></ul></li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DECLARE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> var1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DECLARE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a, b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> var1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> var2 :</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> var1, var2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><blockquote><p>注意：结果为空 → 不赋值；结果多条 → 报错。</p></blockquote><h5 id="用户变量-以-开头" tabindex="-1">用户变量（以 <code>@</code> 开头） <a class="header-anchor" href="#用户变量-以-开头" aria-label="Permalink to &quot;用户变量（以 `@` 开头）&quot;">​</a></h5><ul><li>作用域：当前连接有效</li><li>不需预先声明</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @x;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @y :</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h5 id="if-语句" tabindex="-1">IF 语句 <a class="header-anchor" href="#if-语句" aria-label="Permalink to &quot;IF 语句&quot;">​</a></h5><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">IF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">THEN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[ELSEIF condition </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">THEN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ELSE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">END</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> IF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h5 id="while-循环" tabindex="-1">WHILE 循环 <a class="header-anchor" href="#while-循环" aria-label="Permalink to &quot;WHILE 循环&quot;">​</a></h5><p>控制指定 label 的循环</p><ul><li><code>LEAVE label;</code> 跳出循环（相当于 <code>break</code>）</li><li><code>ITERATE label;</code> 继续下一轮（相当于 <code>continue</code>）</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[label:] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHILE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition DO</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">END</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHILE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [label];</span></span></code></pre></div><h5 id="循环控制-leave-iterate" tabindex="-1">循环控制：LEAVE / ITERATE <a class="header-anchor" href="#循环控制-leave-iterate" aria-label="Permalink to &quot;循环控制：LEAVE / ITERATE&quot;">​</a></h5><h4 id="函数相关操作" tabindex="-1">函数相关操作 <a class="header-anchor" href="#函数相关操作" aria-label="Permalink to &quot;函数相关操作&quot;">​</a></h4><h5 id="查看函数状态" tabindex="-1">查看函数状态 <a class="header-anchor" href="#查看函数状态" aria-label="Permalink to &quot;查看函数状态&quot;">​</a></h5><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FUNCTION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> STATUS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [LIKE &#39;funcName&#39;];</span></span></code></pre></div><h5 id="查看函数定义" tabindex="-1">查看函数定义 <a class="header-anchor" href="#查看函数定义" aria-label="Permalink to &quot;查看函数定义&quot;">​</a></h5><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FUNCTION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> funcName;</span></span></code></pre></div><h5 id="修改函数特性" tabindex="-1">修改函数特性 <a class="header-anchor" href="#修改函数特性" aria-label="Permalink to &quot;修改函数特性&quot;">​</a></h5><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FUNCTION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> funcName [characteristic ...];</span></span></code></pre></div><blockquote><p>注意：不能用于修改函数体内容</p></blockquote><h5 id="删除函数" tabindex="-1">删除函数 <a class="header-anchor" href="#删除函数" aria-label="Permalink to &quot;删除函数&quot;">​</a></h5><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FUNCTION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [IF EXISTS] funcName;</span></span></code></pre></div><h4 id="命令行使用注意事项" tabindex="-1">命令行使用注意事项 <a class="header-anchor" href="#命令行使用注意事项" aria-label="Permalink to &quot;命令行使用注意事项&quot;">​</a></h4><p>MySQL 默认以 <code>;</code> 作为语句结束符，<strong>创建函数时建议更改结束符</strong>：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DELIMITER $$</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FUNCTION</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> myFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(...) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RETURNS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $$</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DELIMITER ;</span></span></code></pre></div><h4 id="示例" tabindex="-1">示例 <a class="header-anchor" href="#示例" aria-label="Permalink to &quot;示例&quot;">​</a></h4><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DELIMITER $$</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE FUNCTION get_user_topN_total(p_user_id INT, p_limit INT)</span></span>
<span class="line"><span>RETURNS DECIMAL(10,2)</span></span>
<span class="line"><span>DETERMINISTIC</span></span>
<span class="line"><span>READS SQL DATA</span></span>
<span class="line"><span>COMMENT &#39;返回用户前N个订单金额总和（按订单日期升序）&#39;</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>    -- 声明变量</span></span>
<span class="line"><span>    DECLARE done INT DEFAULT 0;               -- 游标读取结束标志，0=未结束，1=结束</span></span>
<span class="line"><span>    DECLARE total DECIMAL(10,2) DEFAULT 0.00;-- 用于累计订单金额总和，初始为0</span></span>
<span class="line"><span>    DECLARE i INT DEFAULT 0;                   -- 计数器，记录已累计订单数</span></span>
<span class="line"><span>    DECLARE order_amt DECIMAL(10,2);          -- 游标当前读取的订单金额</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    -- 定义游标，查询指定用户订单金额，按订单日期升序排列</span></span>
<span class="line"><span>    DECLARE order_cursor CURSOR FOR</span></span>
<span class="line"><span>        SELECT amount FROM orders</span></span>
<span class="line"><span>        WHERE user_id = p_user_id</span></span>
<span class="line"><span>        ORDER BY order_date ASC;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    -- 声明当游标读取不到更多数据时的处理器，将 done 设为1</span></span>
<span class="line"><span>    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    -- 打开游标，准备开始读取数据</span></span>
<span class="line"><span>    OPEN order_cursor;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    -- 循环标签，方便使用 LEAVE 跳出循环</span></span>
<span class="line"><span>    order_loop: WHILE i &lt; p_limit DO</span></span>
<span class="line"><span>        -- 从游标取一条记录，赋值给 order_amt</span></span>
<span class="line"><span>        FETCH order_cursor INTO order_amt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        -- 如果没有更多记录（done=1），跳出循环</span></span>
<span class="line"><span>        IF done = 1 THEN</span></span>
<span class="line"><span>            LEAVE order_loop;</span></span>
<span class="line"><span>        END IF;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        -- 累加当前订单金额，使用 IFNULL 避免 NULL 导致错误</span></span>
<span class="line"><span>        SET total = total + IFNULL(order_amt, 0);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        -- 订单计数器加1</span></span>
<span class="line"><span>        SET i = i + 1;</span></span>
<span class="line"><span>    END WHILE order_loop;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    -- 关闭游标，释放资源</span></span>
<span class="line"><span>    CLOSE order_cursor;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    -- 返回累计的订单金额总和</span></span>
<span class="line"><span>    RETURN total;</span></span>
<span class="line"><span>END $$</span></span>
<span class="line"><span></span></span>
<span class="line"><span>DELIMITER ;</span></span></code></pre></div><h2 id="视图-view" tabindex="-1">视图(VIEW) <a class="header-anchor" href="#视图-view" aria-label="Permalink to &quot;视图(VIEW)&quot;">​</a></h2><h3 id="介绍" tabindex="-1">介绍 <a class="header-anchor" href="#介绍" aria-label="Permalink to &quot;介绍&quot;">​</a></h3><p><strong>概念与特点</strong></p><blockquote><p>视图是基于SQL查询结果集的虚拟表，它不存储实际数据，而是在使用时动态执行预定义的SQL查询语句来生成结果。<em>视图本质上是一个保存的查询</em>，对外表现为一张表，但数据来源于一个或多个实际表。</p></blockquote><p><strong>核心优势</strong></p><blockquote><p>视图能够简化复杂的SQL查询操作，让用户无需编写冗长的多表关联语句；提供数据安全保护机制，可以限制用户只能访问特定的列或行；增强数据库的逻辑独立性，当底层表结构发生变化时，通过调整视图定义可以保持应用接口的稳定性；同时支持代码重用，避免重复编写相同的查询逻辑。</p></blockquote><p><strong>使用注意</strong></p><blockquote><p>视图在每次查询时都需要重新执行底层SQL语句，可能会带来性能开销；并非所有视图都支持更新操作，只有满足特定条件的简单视图才能进行INSERT、UPDATE、DELETE操作；过度使用嵌套视图可能导致逻辑复杂难以维护和调试。</p></blockquote><p><strong>应用场景</strong></p><blockquote><p>视图广泛应用于简化复杂的多表关联查询、隐藏敏感数据字段以保护隐私信息、为不同用户角色提供定制化的数据访问接口、以及在数据库重构时保持应用程序的向后兼容性。</p></blockquote><h3 id="基本操作语法" tabindex="-1">基本操作语法 <a class="header-anchor" href="#基本操作语法" aria-label="Permalink to &quot;基本操作语法&quot;">​</a></h3><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- 创建视图</span></span>
<span class="line"><span>CREATE VIEW view_name AS SELECT 查询语句;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 使用视图（当作普通表查询）</span></span>
<span class="line"><span>SELECT * FROM view_name WHERE 条件;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 修改视图（替换现有定义）</span></span>
<span class="line"><span>CREATE OR REPLACE VIEW view_name AS SELECT 新查询语句;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 删除视图</span></span>
<span class="line"><span>DROP VIEW view_name;</span></span></code></pre></div><h2 id="游标-cursor" tabindex="-1">游标(CURSOR) <a class="header-anchor" href="#游标-cursor" aria-label="Permalink to &quot;游标(CURSOR)&quot;">​</a></h2><h3 id="介绍-1" tabindex="-1">介绍 <a class="header-anchor" href="#介绍-1" aria-label="Permalink to &quot;介绍&quot;">​</a></h3><p><strong>概念与特点</strong></p><blockquote><p>游标是数据库系统中用于逐行处理查询结果集的数据库对象，<em>它提供了一种在程序中逐条读取和操作数据的方法</em>。与普通查询一次性返回所有结果不同，游标允许开发者按需逐行处理数据，特别适用于需要对每一行数据进行复杂处理的场景。</p></blockquote><p><strong>核心优势</strong></p><blockquote><p>游标能够实现对查询结果集的逐行精确控制，支持定位到特定行、向前或向后移动；适合处理大量数据时的内存管理，避免一次性加载所有数据；提供灵活的数据操作方式，可以在处理过程中根据条件动态修改、删除或插入数据；特别适用于需要基于当前行数据值来决定后续操作逻辑的复杂业务场景。</p></blockquote><p><strong>使用注意</strong></p><blockquote><p>游标会消耗较多的系统资源和内存，处理大量数据时可能影响性能；逐行处理方式比集合操作慢得多，应优先考虑使用SQL集合操作；需要手动管理游标的生命周期，包括打开、关闭和释放资源；在高并发环境下使用游标可能导致锁等待和性能瓶颈。</p></blockquote><p><strong>应用场景</strong></p><blockquote><p>游标主要用于需要逐行处理数据的复杂业务逻辑、数据迁移和转换操作、基于当前行数据动态生成其他数据、批量数据的验证和清理工作、以及需要在处理过程中与其他系统进行交互的场景。</p></blockquote><h3 id="基本操作语法-1" tabindex="-1">基本操作语法 <a class="header-anchor" href="#基本操作语法-1" aria-label="Permalink to &quot;基本操作语法&quot;">​</a></h3><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- 声明游标</span></span>
<span class="line"><span>DECLARE cursor_name CURSOR FOR SELECT 查询语句;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 打开游标</span></span>
<span class="line"><span>OPEN cursor_name;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 读取数据</span></span>
<span class="line"><span>FETCH NEXT FROM cursor_name INTO variable_list;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 关闭游标</span></span>
<span class="line"><span>CLOSE cursor_name;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 释放游标</span></span>
<span class="line"><span>DEALLOCATE cursor_name;</span></span></code></pre></div><h2 id="存储过程-procedure" tabindex="-1">存储过程(PROCEDURE) <a class="header-anchor" href="#存储过程-procedure" aria-label="Permalink to &quot;存储过程(PROCEDURE)&quot;">​</a></h2><h3 id="简介" tabindex="-1">简介 <a class="header-anchor" href="#简介" aria-label="Permalink to &quot;简介&quot;">​</a></h3><p><strong>SQL 存储过程</strong> 是一组预编译的 SQL 语句，它们被命名、存储在数据库中，并且可以像函数一样被调用。它们本质上是为了执行特定任务而编写的 SQL 代码块。</p><h3 id="优缺点" tabindex="-1">优缺点 <a class="header-anchor" href="#优缺点" aria-label="Permalink to &quot;优缺点&quot;">​</a></h3><blockquote><p><strong>性能提升</strong>是其核心优势，因为它们被预先编译，减少了重复解析。它们还能提高<strong>代码重用性</strong>，减少重复编码。在<strong>安全性</strong>方面，存储过程允许你通过控制执行权限来保护底层数据。此外，它们能<strong>减少网络流量</strong>并有助于<strong>封装业务逻辑</strong>，确保数据一致性。</p></blockquote><blockquote><p>主要缺点在于<strong>可移植性差</strong>，不同数据库系统间的语法差异大。<strong>调试困难</strong>也是一个挑战，且<strong>版本控制</strong>不如应用程序代码方便。最后，设计不当的存储过程可能<strong>增加数据库负担</strong>。</p></blockquote><h3 id="存储过程的基本结构" tabindex="-1">存储过程的基本结构 <a class="header-anchor" href="#存储过程的基本结构" aria-label="Permalink to &quot;存储过程的基本结构&quot;">​</a></h3><ol><li><strong>定义</strong></li></ol><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PROCEDURE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> procedure_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	-- SQL 语句</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 某些系统如MySQL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">//</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PROCEDURE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> procedure_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (parameter1 datatype, parameter2 datatype, ...)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	-- SQL 语句</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">END</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> //</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DELIMITER ;</span></span></code></pre></div><ol start="2"><li><strong>参数：</strong> 存储过程可以接受输入参数 (IN)、输出参数 (OUT) 或输入/输出参数 (INOUT)，以便在执行时传递数据或返回结果。 <ul><li><strong>IN 参数：</strong> 默认类型，用于向存储过程传递值。</li><li><strong>OUT 参数：</strong> 用于从存储过程返回值。</li><li><strong>INOUT 参数：</strong> 既可以作为输入也可以作为输出。</li></ul></li><li><strong>SQL 语句：</strong> 存储过程中包含各种 SQL 语句，例如 <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>, <code>CREATE TABLE</code> 等，以及流程控制语句（如 <code>IF</code>, <code>WHILE</code>, <code>CASE</code> 等）。</li></ol><h3 id="示例-1" tabindex="-1">示例 <a class="header-anchor" href="#示例-1" aria-label="Permalink to &quot;示例&quot;">​</a></h3><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DELIMITER //</span></span>
<span class="line"><span>CREATE PROCEDURE GetProductDetails (IN ProductID INT)</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>    SELECT ProductName, Price, StockQuantity</span></span>
<span class="line"><span>    FROM Products</span></span>
<span class="line"><span>    WHERE ProductID = ProductID;</span></span>
<span class="line"><span>END //</span></span>
<span class="line"><span>DELIMITER ;</span></span></code></pre></div><p><strong>调用存储过程：</strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CALL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GetProductDetails(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h2 id="触发器-trigger" tabindex="-1">触发器(TRIGGER) <a class="header-anchor" href="#触发器-trigger" aria-label="Permalink to &quot;触发器(TRIGGER)&quot;">​</a></h2><h3 id="简介-1" tabindex="-1">简介 <a class="header-anchor" href="#简介-1" aria-label="Permalink to &quot;简介&quot;">​</a></h3><p><strong>SQL 触发器</strong> 是一种特殊的存储过程，它不是被手动调用执行的，而是由特定的数据库事件自动触发执行的。这些事件通常包括对表的 <code>INSERT</code>（插入）、<code>UPDATE</code>（更新）或 <code>DELETE</code>（删除）操作，也可以是 DDL（数据定义语言）事件，如 <code>CREATE TABLE</code> 或 <code>ALTER TABLE</code>，甚至可以是数据库启动或关闭等事件（尽管这些在不同数据库系统中的支持程度不同）。</p><p>它们的<strong>优点</strong>在于能强制执行复杂的<strong>业务规则</strong>、实现<strong>数据审计</strong>、自动<strong>同步数据</strong>和封装<strong>复杂逻辑</strong>；然而，其<strong>缺点</strong>也显而易见，即<strong>隐式执行</strong>的特性导致<strong>调试困难</strong>，可能产生<strong>性能开销</strong>，并增加系统的<strong>复杂性</strong>和<strong>维护挑战</strong>。简而言之，触发器功能强大但需谨慎使用。</p><h3 id="触发器的执行时机" tabindex="-1">触发器的执行时机 <a class="header-anchor" href="#触发器的执行时机" aria-label="Permalink to &quot;触发器的执行时机&quot;">​</a></h3><p>触发器可以根据事件发生的时机分为两大类：</p><ul><li><strong><code>BEFORE</code> 触发器：</strong> 在 SQL 操作（<code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>）发生<strong>之前</strong>执行。这允许你在实际操作执行前验证或修改数据。如果 <code>BEFORE</code> 触发器中的逻辑导致错误，那么原始的 SQL 操作将被回滚。</li><li><strong><code>AFTER</code> 触发器：</strong> 在 SQL 操作（<code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>）发生<strong>之后</strong>执行。这通常用于在数据已经改变后执行额外的操作，例如更新相关表或记录日志。</li></ul><h3 id="触发器的基本结构" tabindex="-1">触发器的基本结构 <a class="header-anchor" href="#触发器的基本结构" aria-label="Permalink to &quot;触发器的基本结构&quot;">​</a></h3><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DELIMITER //</span></span>
<span class="line"><span>CREATE TRIGGER trg_CheckProductPrice</span></span>
<span class="line"><span>BEFORE INSERT ON Products</span></span>
<span class="line"><span>FOR EACH ROW</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>    IF NEW.Price &lt;= 0 THEN</span></span>
<span class="line"><span>        SIGNAL SQLSTATE &#39;45000&#39; SET MESSAGE_TEXT = &#39;Product price must be greater than zero.&#39;;</span></span>
<span class="line"><span>    END IF;</span></span>
<span class="line"><span>END //</span></span>
<span class="line"><span>DELIMITER ;</span></span></code></pre></div><p>这个触发器会在 <code>Products</code> 表插入新记录<strong>之前</strong>执行，如果新产品的价格小于或等于零，则阻止插入并抛出错误。</p><h3 id="触发器中的特殊表-变量" tabindex="-1">触发器中的特殊表/变量 <a class="header-anchor" href="#触发器中的特殊表-变量" aria-label="Permalink to &quot;触发器中的特殊表/变量&quot;">​</a></h3><p>在 <code>INSERT</code>、<code>UPDATE</code>、<code>DELETE</code> 触发器中，通常会有一些特殊的“虚拟表”或变量来表示数据更改：</p><ul><li><strong>MySQL:</strong><ul><li><code>NEW</code>：对于 <code>INSERT</code> 和 <code>UPDATE</code> 操作，代表新插入或修改后的行数据。</li><li><code>OLD</code>：对于 <code>DELETE</code> 和 <code>UPDATE</code> 操作，代表被删除或修改前的行数据。</li></ul></li></ul><h2 id="事务管理" tabindex="-1">事务管理 <a class="header-anchor" href="#事务管理" aria-label="Permalink to &quot;事务管理&quot;">​</a></h2><h3 id="简介-2" tabindex="-1">简介 <a class="header-anchor" href="#简介-2" aria-label="Permalink to &quot;简介&quot;">​</a></h3><p>在 SQL 中，<strong>事务（Transaction）</strong> 是一个或多个 SQL 语句的序列，这些语句被当作一个单一的、不可分割的逻辑工作单元来执行。简单来说，事务中的所有操作要么全部成功执行，要么全部失败回滚，不会出现只执行了一部分的情况。</p><h3 id="事务的四大特性-acid" tabindex="-1">事务的四大特性 (ACID) <a class="header-anchor" href="#事务的四大特性-acid" aria-label="Permalink to &quot;事务的四大特性 (ACID)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>特性</th><th>英文</th><th>描述</th></tr></thead><tbody><tr><td><strong>原子性 (Atomicity)</strong></td><td>Atomicity</td><td>一个事务是一个不可分割的工作单元。事务中的所有操作要么全部提交成功，要么全部失败回滚。即使发生错误，数据库也必须能够回到事务开始前的状态。</td></tr><tr><td><strong>一致性 (Consistency)</strong></td><td>Consistency</td><td>事务必须使数据库从一个一致性状态转变到另一个一致性状态。在事务开始之前和事务结束以后，数据库的完整性约束没有被破坏。例如，在转账前后，银行系统中所有账户的总金额应该是不变的。</td></tr><tr><td><strong>隔离性 (Isolation)</strong></td><td>Isolation</td><td>隔离性保证了多个并发事务同时对数据库进行读写时，一个事务的执行不应被其他事务干扰。事务处理过程中的中间状态对其他事务是不可见的。换句话说，对于任何一个事务来说，其他并发事务要么在它开始之前就已经结束，要么在它结束之后才开始。</td></tr><tr><td><strong>持久性 (Durability)</strong></td><td>Durability</td><td>一旦事务被成功提交，它对数据库的改变就是永久性的。即使后续系统发生故障（如断电或系统崩溃），已提交的数据也不会丢失。</td></tr></tbody></table><h3 id="sql-中的事务控制命令" tabindex="-1">SQL 中的事务控制命令 <a class="header-anchor" href="#sql-中的事务控制命令" aria-label="Permalink to &quot;SQL 中的事务控制命令&quot;">​</a></h3><ul><li><strong><code>BEGIN TRANSACTION</code></strong> 或 <strong><code>START TRANSACTION</code></strong> 显式地开始一个新事务。</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">START TRANSACTION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><ul><li><strong><code>COMMIT</code></strong> 提交事务。将事务中所有已执行的 SQL 操作永久地保存到数据库中，并结束当前事务。</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COMMIT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><ul><li><strong><code>ROLLBACK</code></strong> 回滚事务。撤销当前事务中所有已执行但未提交的操作，使数据库恢复到事务开始前的状态，并结束当前事务。</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROLLBACK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><ul><li><strong><code>SAVEPOINT savepoint_name</code></strong> 在事务内部创建一个保存点。这允许你在事务的某个点设置一个“书签”，如果后续操作出现问题，你可以选择只回滚到这个保存点，而不必撤销整个事务。</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SAVEPOINT my_savepoint;</span></span></code></pre></div><ul><li><strong><code>ROLLBACK TO SAVEPOINT savepoint_name</code></strong> 回滚到指定的保存点。这会撤销从该保存点到当前位置之间的所有操作。</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROLLBACK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SAVEPOINT my_savepoint;</span></span></code></pre></div><h3 id="事务管理示例" tabindex="-1">事务管理示例 <a class="header-anchor" href="#事务管理示例" aria-label="Permalink to &quot;事务管理示例&quot;">​</a></h3><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- 假设存在一个名为 &#39;accounts&#39; 的表，包含 &#39;account_id&#39; 和 &#39;balance&#39; 字段</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 1. 开始一个新事务</span></span>
<span class="line"><span>START TRANSACTION;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 2. 检查账户 A 是否有足够余额 (这部分逻辑通常在应用代码中完成，这里为了演示省略)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 3. 从账户 A (ID: 1) 扣款 100 元</span></span>
<span class="line"><span>UPDATE accounts SET balance = balance - 100 WHERE account_id = 1;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 4. 向账户 B (ID: 2) 存款 100 元</span></span>
<span class="line"><span>UPDATE accounts SET balance = balance + 100 WHERE account_id = 2;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 假设在执行完上述两条更新后，我们进行检查</span></span>
<span class="line"><span>-- 如果发现账户 B 不存在或者其他问题，我们可以回滚，如果一切正常，提交事务</span></span>
<span class="line"><span>IF some_error_condition THEN</span></span>
<span class="line"><span>     ROLLBACK;</span></span>
<span class="line"><span>ELSE</span></span>
<span class="line"><span>     COMMIT;</span></span>
<span class="line"><span>END IF;</span></span></code></pre></div><p>在这个例子中：</p><ul><li>如果 <code>COMMIT</code> 被执行，那么两个 <code>UPDATE</code> 语句的修改将永久生效。</li><li>如果在 <code>COMMIT</code> 之前发生了任何错误（例如数据库连接中断，或者应用代码检测到异常），我们可以执行 <code>ROLLBACK</code>，数据库将撤销这两个 <code>UPDATE</code> 操作，两个账户的余额都会恢复到事务开始前的状态。</li></ul><h3 id="事务隔离级别-isolation-levels" tabindex="-1">事务隔离级别 (Isolation Levels) <a class="header-anchor" href="#事务隔离级别-isolation-levels" aria-label="Permalink to &quot;事务隔离级别 (Isolation Levels)&quot;">​</a></h3><p>为了解决多个事务并发执行时可能出现的问题（如脏读、不可重复读、幻读），SQL 标准定义了四种不同的<strong>隔离级别</strong>。隔离级别越高，数据的完整性越好，但并发性能可能会越低。使用 <code>SET TRANSACTION ISOLATION LEVEL</code> 命令来设置当前事务的隔离级别</p><ol><li><strong>读未提交 (Read Uncommitted)</strong>：最低级别。一个事务可以读取到另一个事务尚未提交的更改。这可能导致“脏读”（Dirty Read）。</li><li><strong>读已提交 (Read Committed)</strong>：一个事务只能读取到其他事务已经提交的数据。这是大多数数据库系统默认的隔离级别（如 Oracle, SQL Server, PostgreSQL）。它可以避免脏读，但可能出现“不可重复读”。</li><li><strong>可重复读 (Repeatable Read)</strong>：保证在同一个事务中多次读取同一行数据时，结果总是一致的。它可以避免脏读和不可重复读，但仍可能出现“幻读”。这是 MySQL (InnoDB) 的默认隔离级别。</li><li><strong>可串行化 (Serializable)</strong>：最高级别。强制事务串行执行，完全避免了脏读、不可重复读和幻读。但由于它极大地限制了并发，因此性能开销最大。</li></ol><h2 id="字符集" tabindex="-1">字符集 <a class="header-anchor" href="#字符集" aria-label="Permalink to &quot;字符集&quot;">​</a></h2><h3 id="介绍-2" tabindex="-1">介绍 <a class="header-anchor" href="#介绍-2" aria-label="Permalink to &quot;介绍&quot;">​</a></h3><p>在SQL中，<strong>字符集</strong>（Character Set）是定义文本数据如何存储和处理的一套规则。它决定了哪些字符可以被表示，以及每个字符在计算机内存中如何编码（即对应的二进制值）。理解字符集对于正确处理多语言数据、避免乱码以及优化数据库性能至关重要。</p><p>简单来说，字符集就像一个巨大的字典，里面列出了所有可以使用的字符（字母、数字、符号、特殊字符等）以及它们对应的唯一数字编码。例如，字符 &#39;A&#39; 可能被编码为数字 65，字符 &#39;B&#39; 编码为 66。</p><h3 id="为什么字符集很重要" tabindex="-1">为什么字符集很重要？ <a class="header-anchor" href="#为什么字符集很重要" aria-label="Permalink to &quot;为什么字符集很重要？&quot;">​</a></h3><ol><li><strong>数据准确性</strong>：如果数据库和应用程序使用的字符集不一致，存储和检索的数据可能会出现乱码或数据丢失。例如，一个用UTF-8编码的字符在用GBK编码的系统上显示，就可能出现乱码。</li><li><strong>国际化支持</strong>：不同的语言有不同的字符。一个支持多种语言的数据库需要使用能够涵盖这些语言所有字符的字符集，如UTF-8。</li><li><strong>排序和比较</strong>：字符集还会影响文本数据的排序和比较规则。例如，在某些字符集中 &#39;a&#39; 和 &#39;A&#39; 可能被认为是相同的，而在另一些字符集中则被认为是不同的。这由字符集相关的<strong>排序规则</strong>（Collation）决定。</li><li><strong>存储效率</strong>：不同的字符集对同一字符可能使用不同数量的字节来存储。选择合适的字符集可以影响存储空间的使用效率。</li></ol><h3 id="常见的字符集" tabindex="-1">常见的字符集 <a class="header-anchor" href="#常见的字符集" aria-label="Permalink to &quot;常见的字符集&quot;">​</a></h3><ul><li><strong>ASCII</strong>：最古老的字符集之一，只包含128个字符（0-127），主要用于英文字符和基本符号。</li><li><strong>Latin1 (ISO-8859-1)</strong>：在ASCII基础上扩展了欧洲常用字符，包含256个字符（0-255）。</li><li><strong>GBK/GB2312</strong>：主要用于简体中文。GBK是GB2312的扩展，包含了更多的汉字。</li><li><strong>BIG5</strong>：主要用于繁体中文。</li><li><strong>UTF-8</strong>：目前最推荐和广泛使用的字符集。它是一种变长编码，可以表示Unicode标准中的所有字符，包括世界上几乎所有的语言文字。它的优势在于： <ul><li><strong>兼容性好</strong>：能处理多种语言，避免乱码。</li><li><strong>节省空间</strong>：对于ASCII字符，UTF-8只占用1个字节，对于其他字符则根据需要占用2到4个字节，因此在存储英文和中文混合数据时比较高效。</li></ul></li></ul><h3 id="sql中字符集的应用" tabindex="-1">SQL中字符集的应用 <a class="header-anchor" href="#sql中字符集的应用" aria-label="Permalink to &quot;SQL中字符集的应用&quot;">​</a></h3><p>字符集可以在SQL数据库的多个层面进行设置：</p><ol><li><strong>服务器级别</strong>：整个数据库服务器的默认字符集。</li><li><strong>数据库级别</strong>：特定数据库的默认字符集。</li><li><strong>表级别</strong>：特定数据表的默认字符集。</li><li><strong>列级别</strong>：特定列的字符集，这是最细粒度的设置。</li></ol><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- 创建一个使用UTF-8字符集的数据库</span></span>
<span class="line"><span>CREATE DATABASE mydatabase CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 创建一个使用UTF-8字符集的表</span></span>
<span class="line"><span>CREATE TABLE mytable (</span></span>
<span class="line"><span>    id INT PRIMARY KEY,</span></span>
<span class="line"><span>    name VARCHAR(255) CHARACTER SET utf8mb4</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 修改列的字符集</span></span>
<span class="line"><span>ALTER TABLE mytable MODIFY COLUMN name VARCHAR(255) CHARACTER SET utf8mb4;</span></span></code></pre></div><h3 id="字符集与排序规则-collation" tabindex="-1">字符集与排序规则 (Collation) <a class="header-anchor" href="#字符集与排序规则-collation" aria-label="Permalink to &quot;字符集与排序规则 (Collation)&quot;">​</a></h3><p>字符集通常与<strong>排序规则</strong>（Collation）紧密相关。一个字符集可以有多个排序规则。排序规则定义了如何比较和排序字符数据，包括是否区分大小写、重音符号等。 例如，<code>utf8mb4_unicode_ci</code> 是一个常见的UTF-8排序规则，其中的 <code>ci</code> 表示 <code>case-insensitive</code> (不区分大小写)，而 <code>cs</code> 则表示 <code>case-sensitive</code> (区分大小写)。</p><h2 id="权限管理" tabindex="-1">权限管理 <a class="header-anchor" href="#权限管理" aria-label="Permalink to &quot;权限管理&quot;">​</a></h2><h3 id="介绍-3" tabindex="-1">介绍 <a class="header-anchor" href="#介绍-3" aria-label="Permalink to &quot;介绍&quot;">​</a></h3><p>SQL 权限管理是数据库安全的核心组成部分，它决定了哪些用户可以对数据库中的哪些对象（如表、视图、存储过程等）执行哪些操作。通过精细的权限控制，可以保护数据的机密性、完整性和可用性，防止未经授权的访问和恶意操作。</p><h3 id="核心概念" tabindex="-1">核心概念 <a class="header-anchor" href="#核心概念" aria-label="Permalink to &quot;核心概念&quot;">​</a></h3><h4 id="_1-用户-users-和-角色-roles" tabindex="-1">1. 用户 (Users) 和 角色 (Roles) <a class="header-anchor" href="#_1-用户-users-和-角色-roles" aria-label="Permalink to &quot;1. 用户 (Users) 和 角色 (Roles)&quot;">​</a></h4><ul><li><strong>用户 (Users)：</strong> 数据库中独立存在的个体，通常对应于实际的个人或应用程序。每个用户都有自己的登录凭据和与之关联的权限。</li><li><strong>角色 (Roles)：</strong> 权限的集合。通过将权限赋予角色，然后将角色赋予用户，可以简化权限管理。当需要修改一组用户的权限时，只需修改角色的权限即可，而无需逐一修改每个用户的权限。这种方式也称为 <strong>RBAC (Role-Based Access Control)</strong>。</li></ul><h4 id="_2-权限-privileges" tabindex="-1">2. 权限 (Privileges) <a class="header-anchor" href="#_2-权限-privileges" aria-label="Permalink to &quot;2. 权限 (Privileges)&quot;">​</a></h4><p>权限是指用户或角色可以执行的特定操作。常见的权限类型包括：</p><ul><li><strong>数据操作语言 (DML) 权限</strong>：SELECT、INSERT、UPDATE、DELETE</li><li><strong>数据定义语言 (DDL) 权限</strong>：CREATE、ALTER、DROP</li><li><strong>数据控制语言 (DCL) 权限</strong>：GRANT(授予权限)、REVOKE(撤销权限)</li><li><strong>管理权限：</strong><ul><li><strong>ALL PRIVILEGES：</strong> 授予所有权限（通常不推荐在生产环境中使用）</li><li><strong>SUPER/DBA：</strong> 数据库管理员权限，拥有最高权限</li><li><strong>EXECUTE：</strong> 执行存储过程或函数</li><li><strong>REFERENCES：</strong> 引用其他表或视图</li></ul></li></ul><h4 id="_3-授予-grant-和-撤销-revoke" tabindex="-1">3. 授予 (GRANT) 和 撤销 (REVOKE) <a class="header-anchor" href="#_3-授予-grant-和-撤销-revoke" aria-label="Permalink to &quot;3. 授予 (GRANT) 和 撤销 (REVOKE)&quot;">​</a></h4><div class="language-mysql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-- 授予用户 &#39;john_doe&#39; 对 &#39;employees&#39; 表的 SELECT 权限</span></span>
<span class="line"><span>GRANT SELECT ON employees TO john_doe;</span></span>
<span class="line"><span>-- 授予角色 &#39;data_analyst&#39; 对 &#39;sales&#39; 数据库中所有表的 SELECT 和 INSERT 权限</span></span>
<span class="line"><span>GRANT SELECT, INSERT ON DATABASE sales TO data_analyst;</span></span>
<span class="line"><span>-- 授予用户 &#39;app_user&#39; 执行 &#39;calculate_total_sales&#39; 存储过程的权限</span></span>
<span class="line"><span>GRANT EXECUTE ON PROCEDURE calculate_total_sales TO app_user;</span></span>
<span class="line"><span>-- 授予用户 &#39;mary_smith&#39; 对 &#39;products&#39; 表的 UPDATE 权限，并允许她将此权限授予其他用户</span></span>
<span class="line"><span>GRANT UPDATE ON products TO mary_smith WITH GRANT OPTION;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- 撤销用户 &#39;john_doe&#39; 对 &#39;employees&#39; 表的 SELECT 权限</span></span>
<span class="line"><span>REVOKE SELECT ON employees FROM john_doe;</span></span>
<span class="line"><span>-- 撤销角色 &#39;data_analyst&#39; 对 &#39;sales&#39; 数据库中所有表的 SELECT 权限</span></span>
<span class="line"><span>REVOKE SELECT ON DATABASE sales FROM data_analyst;</span></span>
<span class="line"><span>-- 撤销用户 &#39;mary_smith&#39; 对 &#39;products&#39; 表的 UPDATE 权限，即使她之前拥有 WITH GRANT OPTION</span></span>
<span class="line"><span>REVOKE UPDATE ON products FROM mary_smith CASCADE;</span></span></code></pre></div><ul><li><code>WITH GRANT OPTION</code> 允许被授予权限的用户将此权限再授予其他用户。</li><li><code>CASCADE</code> 关键字表示如果被撤销权限的用户曾将此权限授予其他用户，那么这些用户的权限也会被级联撤销。</li></ul><h3 id="最佳实践" tabindex="-1">最佳实践 <a class="header-anchor" href="#最佳实践" aria-label="Permalink to &quot;最佳实践&quot;">​</a></h3><ol><li><strong>最小权限原则 (Principle of Least Privilege)：</strong> 只授予用户完成其工作所需的最小权限。不要授予不必要的权限，特别是 <code>ALL PRIVILEGES</code> 或 <code>SUPER</code> 权限。</li><li><strong>使用角色管理权限：</strong> 优先使用角色来管理权限，而不是直接将权限授予每个用户。这大大简化了权限管理，特别是当用户数量众多或权限需求频繁变动时。</li><li><strong>定期审查权限：</strong> 定期检查并更新用户和角色的权限，确保其与当前职责保持一致。当用户离职或职责发生变化时，及时调整或撤销其权限。</li><li><strong>避免共享账户：</strong> 每个用户都应该有独立的账户。共享账户难以审计，且无法追溯具体操作人员。</li><li><strong>强密码策略：</strong> 强制用户使用复杂且定期的密码，并定期更换。</li><li><strong>记录和审计：</strong> 启用数据库审计功能，记录重要的权限变更和用户操作，以便在发生安全事件时进行追溯和分析。</li><li><strong>区分开发、测试和生产环境：</strong> 在不同的环境中设置不同的权限策略，生产环境的权限控制应最为严格。</li><li><strong>考虑行级安全 (Row-Level Security)：</strong> 对于需要更细粒度控制的场景，可以使用行级安全，即根据用户身份限制其只能访问特定行的数据。</li></ol></div></div></main><!----><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"articles_crawl4ai.md\":\"mm-s6my-\",\"articles_index.md\":\"BjeWHYUn\",\"index.md\":\"DfoJq8Ge\",\"notes_docker.md\":\"a_ZctXhn\",\"notes_git命令.md\":\"BoDvR4rk\",\"notes_index.md\":\"B_661fhs\",\"notes_java基础知识.md\":\"CECufmGO\",\"notes_java框架学习.md\":\"DafYC2lm\",\"notes_linux.md\":\"CX3ImbzO\",\"notes_python.md\":\"DdjSwtm0\",\"notes_sql.md\":\"DW9Qcse8\",\"notes_vue.md\":\"Chdgua3G\",\"notes_算法.md\":\"Bqodmab8\",\"others_index.md\":\"DEoNt0YR\",\"projects_index.md\":\"Dl9gIp2U\",\"projects_mfcgames.md\":\"7mTEi3o1\",\"projects_osutool.md\":\"CgowA9F7\",\"projects_rougekiller.md\":\"CA1c_bxL\",\"vitepress-tutorial_guide_asset-handling.md\":\"Bz37ycSW\",\"vitepress-tutorial_guide_cms.md\":\"BJkmZHvs\",\"vitepress-tutorial_guide_custom-theme.md\":\"39rczaWg\",\"vitepress-tutorial_guide_data-loading.md\":\"C5LvklwM\",\"vitepress-tutorial_guide_deploy.md\":\"DXp1DVD1\",\"vitepress-tutorial_guide_extending-default-theme.md\":\"DZpdMB9o\",\"vitepress-tutorial_guide_frontmatter.md\":\"CQWQ2kSm\",\"vitepress-tutorial_guide_getting-started.md\":\"CzqXwDpM\",\"vitepress-tutorial_guide_i18n.md\":\"BhAuQpPO\",\"vitepress-tutorial_guide_markdown.md\":\"tVbxMAkG\",\"vitepress-tutorial_guide_migration-from-vitepress-0.md\":\"C0j8HUjZ\",\"vitepress-tutorial_guide_migration-from-vuepress.md\":\"V3bm7lhe\",\"vitepress-tutorial_guide_mpa-mode.md\":\"fSTztdI-\",\"vitepress-tutorial_guide_routing.md\":\"DSjDgj-1\",\"vitepress-tutorial_guide_sitemap-generation.md\":\"C9s6eG5G\",\"vitepress-tutorial_guide_ssr-compat.md\":\"B5Nl0rh0\",\"vitepress-tutorial_guide_using-vue.md\":\"AG4kb0sW\",\"vitepress-tutorial_guide_what-is-vitepress.md\":\"D2dVWLdV\",\"vitepress-tutorial_index.md\":\"CGFsvbXx\",\"vitepress-tutorial_reference_cli.md\":\"Bhfh4SSj\",\"vitepress-tutorial_reference_default-theme-badge.md\":\"uFvT7jZN\",\"vitepress-tutorial_reference_default-theme-carbon-ads.md\":\"CAZI2J6V\",\"vitepress-tutorial_reference_default-theme-config.md\":\"DkPf2ri4\",\"vitepress-tutorial_reference_default-theme-edit-link.md\":\"mGLVQ2Ok\",\"vitepress-tutorial_reference_default-theme-footer.md\":\"mu7_GsxP\",\"vitepress-tutorial_reference_default-theme-home-page.md\":\"Cw7fF1Bl\",\"vitepress-tutorial_reference_default-theme-last-updated.md\":\"C20vxEfP\",\"vitepress-tutorial_reference_default-theme-layout.md\":\"DopA0aG4\",\"vitepress-tutorial_reference_default-theme-nav.md\":\"BhUuhy62\",\"vitepress-tutorial_reference_default-theme-prev-next-links.md\":\"CwnJfSC5\",\"vitepress-tutorial_reference_default-theme-search.md\":\"CzIkEf_A\",\"vitepress-tutorial_reference_default-theme-sidebar.md\":\"BZzQKMoO\",\"vitepress-tutorial_reference_default-theme-team-page.md\":\"CwlYRTW-\",\"vitepress-tutorial_reference_frontmatter-config.md\":\"eXF8xnS9\",\"vitepress-tutorial_reference_runtime-api.md\":\"CW_Wt04Y\",\"vitepress-tutorial_reference_site-config.md\":\"Bvc2Jvqo\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"My Blog\",\"description\":\"xuan_yuan's blog\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/logo.png\",\"nav\":[{\"text\":\"主页\",\"link\":\"/\"},{\"text\":\"项目\",\"link\":\"/projects\"},{\"text\":\"文章\",\"link\":\"/articles\"},{\"text\":\"笔记\",\"link\":\"/notes\"},{\"text\":\"其他\",\"link\":\"/others\"}],\"sidebar\":{\"/projects/\":[{\"text\":\"主页\",\"link\":\"/projects/\"},{\"text\":\"MFCGames\",\"link\":\"/projects/MFCGames\"},{\"text\":\"osutool\",\"link\":\"/projects/osutool\"},{\"text\":\"RougeKiller\",\"link\":\"/projects/RougeKiller\"}],\"/articles/\":[{\"text\":\"主页\",\"link\":\"/articles/\"},{\"text\":\"crawl4ai\",\"link\":\"/articles/crawl4ai\"}],\"/notes/\":[{\"text\":\"主页\",\"link\":\"/notes/\"},{\"text\":\"Docker\",\"link\":\"/notes/Docker\"},{\"text\":\"git命令\",\"link\":\"/notes/git命令\"},{\"text\":\"java基础知识\",\"link\":\"/notes/java基础知识\"},{\"text\":\"java框架学习\",\"link\":\"/notes/java框架学习\"},{\"text\":\"Linux\",\"link\":\"/notes/Linux\"},{\"text\":\"Python\",\"link\":\"/notes/Python\"},{\"text\":\"Sql\",\"link\":\"/notes/Sql\"},{\"text\":\"Vue\",\"link\":\"/notes/Vue\"},{\"text\":\"算法\",\"link\":\"/notes/算法\"}],\"/others/\":[{\"text\":\"主页\",\"link\":\"/others/\"}],\"/vitepress-tutorial\":[{\"text\":\"主页\",\"link\":\"/vitepress-tutorial\"},{\"text\":\"guide\",\"collapsed\":true,\"items\":[{\"text\":\"asset-handling\",\"link\":\"/vitepress-tutorial/guide/asset-handling\"},{\"text\":\"cms\",\"link\":\"/vitepress-tutorial/guide/cms\"},{\"text\":\"custom-theme\",\"link\":\"/vitepress-tutorial/guide/custom-theme\"},{\"text\":\"data-loading\",\"link\":\"/vitepress-tutorial/guide/data-loading\"},{\"text\":\"deploy\",\"link\":\"/vitepress-tutorial/guide/deploy\"},{\"text\":\"extending-default-theme\",\"link\":\"/vitepress-tutorial/guide/extending-default-theme\"},{\"text\":\"frontmatter\",\"link\":\"/vitepress-tutorial/guide/frontmatter\"},{\"text\":\"getting-started\",\"link\":\"/vitepress-tutorial/guide/getting-started\"},{\"text\":\"i18n\",\"link\":\"/vitepress-tutorial/guide/i18n\"},{\"text\":\"markdown\",\"link\":\"/vitepress-tutorial/guide/markdown\"},{\"text\":\"migration-from-vitepress-0\",\"link\":\"/vitepress-tutorial/guide/migration-from-vitepress-0\"},{\"text\":\"migration-from-vuepress\",\"link\":\"/vitepress-tutorial/guide/migration-from-vuepress\"},{\"text\":\"mpa-mode\",\"link\":\"/vitepress-tutorial/guide/mpa-mode\"},{\"text\":\"routing\",\"link\":\"/vitepress-tutorial/guide/routing\"},{\"text\":\"sitemap-generation\",\"link\":\"/vitepress-tutorial/guide/sitemap-generation\"},{\"text\":\"ssr-compat\",\"link\":\"/vitepress-tutorial/guide/ssr-compat\"},{\"text\":\"using-vue\",\"link\":\"/vitepress-tutorial/guide/using-vue\"},{\"text\":\"what-is-vitepress\",\"link\":\"/vitepress-tutorial/guide/what-is-vitepress\"}]},{\"text\":\"reference\",\"collapsed\":true,\"items\":[{\"text\":\"cli\",\"link\":\"/vitepress-tutorial/reference/cli\"},{\"text\":\"default-theme-badge\",\"link\":\"/vitepress-tutorial/reference/default-theme-badge\"},{\"text\":\"default-theme-carbon-ads\",\"link\":\"/vitepress-tutorial/reference/default-theme-carbon-ads\"},{\"text\":\"default-theme-config\",\"link\":\"/vitepress-tutorial/reference/default-theme-config\"},{\"text\":\"default-theme-edit-link\",\"link\":\"/vitepress-tutorial/reference/default-theme-edit-link\"},{\"text\":\"default-theme-footer\",\"link\":\"/vitepress-tutorial/reference/default-theme-footer\"},{\"text\":\"default-theme-home-page\",\"link\":\"/vitepress-tutorial/reference/default-theme-home-page\"},{\"text\":\"default-theme-last-updated\",\"link\":\"/vitepress-tutorial/reference/default-theme-last-updated\"},{\"text\":\"default-theme-layout\",\"link\":\"/vitepress-tutorial/reference/default-theme-layout\"},{\"text\":\"default-theme-nav\",\"link\":\"/vitepress-tutorial/reference/default-theme-nav\"},{\"text\":\"default-theme-prev-next-links\",\"link\":\"/vitepress-tutorial/reference/default-theme-prev-next-links\"},{\"text\":\"default-theme-search\",\"link\":\"/vitepress-tutorial/reference/default-theme-search\"},{\"text\":\"default-theme-sidebar\",\"link\":\"/vitepress-tutorial/reference/default-theme-sidebar\"},{\"text\":\"default-theme-team-page\",\"link\":\"/vitepress-tutorial/reference/default-theme-team-page\"},{\"text\":\"frontmatter-config\",\"link\":\"/vitepress-tutorial/reference/frontmatter-config\"},{\"text\":\"runtime-api\",\"link\":\"/vitepress-tutorial/reference/runtime-api\"},{\"text\":\"site-config\",\"link\":\"/vitepress-tutorial/reference/site-config\"}]}]},\"search\":{\"provider\":\"local\"},\"docFooter\":{\"prev\":false,\"next\":false},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/2710165659/my-blog\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>